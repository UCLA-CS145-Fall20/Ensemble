{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "from scipy.optimize import minimize\n",
    "from scipy.integrate import solve_ivp\n",
    "import matplotlib.pyplot as plt\n",
    "from data import get_state_ndays_data\n",
    "import pandas\n",
    "import random"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Alabama\n",
      "0.9741980836619393\n",
      "[0.0774289  0.00372666 0.17625719 0.05977226 1.45053884 0.06371386\n",
      " 0.78511271 0.06601157]\n",
      "0.9741980836619393\n",
      "[0.0774289  0.00372666 0.17625719 0.05977226 1.45053884 0.06371386\n",
      " 0.78511271 0.06601157]\n",
      "=====\n",
      "validation:\n",
      "[96223.98488673274, 97625.25215653742, 98992.97743666572, 100323.24414992853, 101614.70841632264, 102869.60498979835, 104091.63332497132, 105281.61000522917, 106443.39715224726, 107580.34869161385, 108693.75164021112, 109783.86912826788, 110855.16745670079, 111911.39243504776, 112953.04986861846, 113977.5333335425, 114986.8932182249, 115986.84461333783, 116977.41176149447, 117955.84255228212, 118926.0434236786, 119889.72194787543, 120845.62571079332, 121794.04897187164, 122737.86734820741, 123677.68828705001]\n",
      "prediction:\n",
      "[124611.17500766162, 125540.77578216474, 126466.79195145756, 127389.07088007085, 128308.38231563623, 129225.48679470966, 130140.49397885625, 131052.86236473793, 131962.09527640353, 132870.0923012522, 133777.85030692088, 134684.25270735438, 135586.90498779467, 136488.33419733602, 137391.25839567557, 138294.42291830468, 139193.36636264558, 140090.65426098433, 140989.58852994215, 141888.31191899482, 142783.7274386522, 143679.31982591195, 144575.70941447292, 145470.51321630285, 146363.53369871507, 147257.25317767312]\n",
      "=====\n",
      "Alaska\n",
      "1.965564738686423\n",
      "[0.09422603 0.00257591 0.17964169 0.07436802 1.46850554 0.0653492\n",
      " 0.77860263 0.04206578]\n",
      "1.9648748486050023\n",
      "[0.09454099 0.00259291 0.1793439  0.07428985 1.46781415 0.06526227\n",
      " 0.77890268 0.04191648]\n",
      "1.9654764153164692\n",
      "[0.09423431 0.00257817 0.17962754 0.07436893 1.46847464 0.06534581\n",
      " 0.77861576 0.04205089]\n",
      "1.9654657570683411\n",
      "[0.09423846 0.00257816 0.17962457 0.07436724 1.46846761 0.0653449\n",
      " 0.77861905 0.04205276]\n",
      "1.9638253663070682\n",
      "[0.09535498 0.00284172 0.17982138 0.07390487 1.46907057 0.06536046\n",
      " 0.77752354 0.0386421 ]\n",
      "1.964596866739347\n",
      "[0.094719   0.00262087 0.17959277 0.07411315 1.46851116 0.06521699\n",
      " 0.77839985 0.04154349]\n",
      "1.9667475264783196\n",
      "[0.09583824 0.00237343 0.18383888 0.07223118 1.47444146 0.06624159\n",
      " 0.77651802 0.04514781]\n",
      "1.9654765473193705\n",
      "[0.0942343  0.00257817 0.17962753 0.07436895 1.46847463 0.06534581\n",
      " 0.77861576 0.04205082]\n",
      "1.9650162226202312\n",
      "[0.09425601 0.00260504 0.1797261  0.07434812 1.46868305 0.0653659\n",
      " 0.7784522  0.04175906]\n",
      "1.968324129443279\n",
      "[0.09430576 0.00217285 0.18276413 0.07286045 1.47503597 0.06609329\n",
      " 0.77609292 0.0486976 ]\n",
      "1.9638253663070682\n",
      "[0.09535498 0.00284172 0.17982138 0.07390487 1.46907057 0.06536046\n",
      " 0.77752354 0.0386421 ]\n",
      "=====\n",
      "validation:\n",
      "[3507.4907525313597, 3578.026419416134, 3648.8300582524853, 3719.646956069563, 3790.3637606968305, 3860.9827213579565, 3931.626957576761, 4002.268650686649, 4072.996173725336, 4143.942313064503, 4215.140080867346, 4286.519345025884, 4358.154831011083, 4430.326097986241, 4503.109560283772, 4576.35383556836, 4649.793280518861, 4723.807556084288, 4798.605457716112, 4873.9572025927255, 4949.867034440451, 5026.545877938975, 5103.954723995558, 5181.99996582788, 5260.8369069956825, 5340.527472456969]\n",
      "prediction:\n",
      "[5420.949725414998, 5502.198596974289, 5584.285451319301, 5667.211215852678, 5751.013320069076, 5835.722743260358, 5921.353038449992, 6007.90033239306, 6095.34330200574, 6183.661894777295, 6272.973500938105, 6363.339343384865, 6454.679733601723, 6546.829974237811, 6639.973663065208, 6734.309697454469, 6829.744192415979, 6925.937776672748, 7023.067867067463, 7121.45778928517, 7220.981390383857, 7321.248957676755, 7422.580861255841, 7525.187989590739, 7628.854011178154, 7733.281766101691]\n",
      "=====\n",
      "Arizona\n",
      "0.32184922042121566\n",
      "[0.04956201 0.05177677 0.11376001 0.04208259 1.44114118 0.11102912\n",
      " 0.79785935 0.02776526]\n",
      "0.32184922042121566\n",
      "[0.04956201 0.05177677 0.11376001 0.04208259 1.44114118 0.11102912\n",
      " 0.79785935 0.02776526]\n",
      "=====\n",
      "validation:\n",
      "[183282.74113863474, 184511.41420150374, 185690.66840725124, 186818.0228581338, 187893.4984684189, 188920.13193477233, 189898.21131007644, 190830.86795451157, 191720.99964793777, 192569.76631813424, 193378.0208611352, 194149.61302900512, 194887.35884972045, 195591.95127639297, 196262.34019099426, 196901.6206323038, 197513.48973156937, 198098.23785290413, 198655.02328948458, 199187.24645288032, 199696.56603551205, 200182.72127358045, 200646.49560612513, 201090.42090067486, 201515.49940267278, 201921.23336924586]\n",
      "prediction:\n",
      "[202308.76520743608, 202679.52262255418, 203034.05775126585, 203373.17987954614, 203697.87104104547, 204008.70863496163, 204305.86166239274, 204589.8420820271, 204861.9920386922, 205122.97506251634, 205372.60734665653, 205610.891197811, 205839.44762688407, 206059.055001045, 206269.2879425908, 206469.62691397202, 206661.90843836073, 206846.97007568547, 207024.15516064188, 207193.04230703524, 207355.3222278257, 207511.36217181548, 207660.51417912886, 207803.35019575412, 207940.61654063957, 208072.29261547187]\n",
      "=====\n",
      "Arkansas\n",
      "1.037829323522717\n",
      "[0.06426575 0.00478823 0.19258609 0.07188324 1.49122415 0.06875901\n",
      " 0.769727   0.05566143]\n",
      "1.037829323522717\n",
      "[0.06426575 0.00478823 0.19258609 0.07188324 1.49122415 0.06875901\n",
      " 0.769727   0.05566143]\n",
      "=====\n",
      "validation:\n",
      "[46759.4195121772, 47577.4464831677, 48354.41582408507, 49090.81926682136, 49787.76149983827, 50449.54623350199, 51079.89822380994, 51681.44988256458, 52258.33364885923, 52813.45274612181, 53348.458465707605, 53865.844032403074, 54368.783307157006, 54859.08275029703, 55337.097085904454, 55803.38665599246, 56261.20279459554, 56711.95460592352, 57154.978225164516, 57591.162705631556, 58022.67119519216, 58449.90150893906, 58872.06638834579, 59290.508945975875, 59706.65999721321, 60120.43759884957]\n",
      "prediction:\n",
      "[60530.78487144164, 60939.35326106159, 61346.284268801144, 61751.55183258528, 62155.657996336566, 62558.90914037378, 62961.23979241405, 63362.30319848126, 63762.66576497736, 64163.10974955713, 64563.56009171256, 64963.075615539216, 65361.5378468352, 65760.4716983517, 66160.00011182786, 66558.73499048127, 66956.77001973931, 67355.55869355772, 67754.96504612021, 68153.49280946316, 68551.63980295263, 68950.79312339565, 69350.64926727014, 69749.47040268488, 70147.91955356552, 70547.61616696978]\n",
      "=====\n",
      "California\n",
      "1.177358112108712\n",
      "[1.00000000e-05 4.59683835e-03 1.00000000e-01 1.00000000e-02\n",
      " 3.44228973e+00 3.38039499e-01 5.36628780e-02 6.72669303e-02]\n",
      "1.177358112108712\n",
      "[1.00000000e-05 4.59683835e-03 1.00000000e-01 1.00000000e-02\n",
      " 3.44228973e+00 3.38039499e-01 5.36628780e-02 6.72669303e-02]\n",
      "=====\n",
      "validation:\n",
      "[529639.2157214256, 536432.906223471, 543854.3886642687, 551758.9708610215, 560016.2252237858, 568515.5140352298, 577179.877955273, 585943.5078534866, 594745.2047323836, 603528.3797274192, 612241.0541069906, 620835.8592724359, 629270.4819130355, 637518.9868194984, 645568.8324862231, 653408.3827258125, 661026.676675201, 668413.428795656, 675559.0288727764, 682454.5420164936, 689091.7086610713, 695466.6397044321, 701587.9206038265, 707459.133180786, 713083.7821609078, 718465.8860679276]\n",
      "prediction:\n",
      "[723609.6450122776, 728521.4035748973, 733205.1397745328, 737667.226964368, 741917.025235582, 745963.2894057584, 749814.1688533495, 753477.2075176765, 756959.3438989286, 760266.9110581637, 763405.636617308, 766380.6427591564, 769196.6221422404, 771862.5794274313, 774387.1322558823, 776777.1885499752, 779039.3169345411, 781179.746736861, 783204.3679866642, 785118.7314161301, 786928.0484598872, 788637.1912550131, 790250.7095764237, 791773.8406198751, 793211.659263545, 794568.6315226294]\n",
      "=====\n",
      "Colorado\n",
      "0.18923878760321294\n",
      "[0.07327798 0.00590955 0.13790129 0.04870938 1.40040307 0.05512868\n",
      " 0.79647557 0.04749877]\n",
      "0.18923878760321294\n",
      "[0.07327798 0.00590955 0.13790129 0.04870938 1.40040307 0.05512868\n",
      " 0.79647557 0.04749877]\n",
      "=====\n",
      "validation:\n",
      "[49264.641634037165, 49714.0700208368, 50151.077829862326, 50573.82188911906, 50981.96001515967, 51375.67436653543, 51756.157797954926, 52123.612343332396, 52478.91138996558, 52823.19440223792, 53156.99353527916, 53480.311303197304, 53794.10283840959, 54099.88305009325, 54398.18169466259, 54688.49535881031, 54970.43363469229, 55246.14193911619, 55516.24581391539, 55779.999304909565, 56038.16118721572, 56291.574098480225, 56540.20003516399, 56784.045848179696, 57023.95404387346, 57260.31038879948]\n",
      "prediction:\n",
      "[57492.74263102817, 57721.86993535119, 57947.891355624015, 58170.93643574869, 58391.33048514092, 58609.34702752497, 58825.13258080135, 59038.70665704679, 59250.02534362732, 59459.52860811977, 59667.638286507936, 59874.27528199618, 60079.032520803514, 60282.44618478682, 60485.04873748362, 60686.69086254439, 60886.72012459149, 61085.70670474913, 61284.46745796416, 61482.82964494018, 61679.736409807236, 61875.627154932714, 62071.71555105278, 62267.80921446779, 62462.58529831356, 62656.79238332166]\n",
      "=====\n",
      "Connecticut\n",
      "17.35442644874221\n",
      "[4.26054079e-04 3.83428559e-02 4.34365711e-02 4.31704659e-02\n",
      " 1.89292509e+00 1.17103240e-01 1.00000000e-02 8.89782027e-02]\n",
      "17.634894424958542\n",
      "[4.03068504e-04 4.79367714e-02 4.22904934e-02 4.19619075e-02\n",
      " 1.90559505e+00 1.18552433e-01 1.00000000e-02 8.93865446e-02]\n",
      "0.10106982841949914\n",
      "[5.95156753e-02 1.62426748e-04 6.51711585e-04 4.75988277e-02\n",
      " 1.45276304e+00 4.04130654e-02 3.90732513e-04 2.50601116e-01]\n",
      "0.10106982841949914\n",
      "[5.95156753e-02 1.62426748e-04 6.51711585e-04 4.75988277e-02\n",
      " 1.45276304e+00 4.04130654e-02 3.90732513e-04 2.50601116e-01]\n",
      "=====\n",
      "validation:\n",
      "[50177.83054379087, 50266.280330210444, 50353.890521683126, 50440.940369416036, 50527.71663223632, 50614.51357659118, 50701.632976547815, 50789.38411379345, 50878.083777635366, 50968.056265000836, 51059.63338043718, 51153.154436111756, 51248.966251811915, 51347.42315494505, 51448.88698053859, 51553.72707123999, 51662.32027731673, 51775.04227687635, 51892.24682112371, 52014.32456498208, 52141.6832058327, 52274.74430002525, 52413.94326287789, 52559.729368677225, 52712.56575067832, 52872.929401104695]\n",
      "prediction:\n",
      "[53041.313721660656, 53218.21509977554, 53404.184576080515, 53599.80539474661, 53805.600716362576, 54022.10481928244, 54249.86470537448, 54489.44010002125, 54741.403452119484, 55006.339934080206, 55284.847441828664, 55577.536594804325, 55885.03073596093, 56207.96593176642, 56546.99097220301, 56902.767370767164, 57275.969364469536, 57667.283913835054, 58077.410702902875, 58507.06213922641, 58956.9633538733, 59427.851054447034, 59920.25388204696, 60434.6697059038, 60971.705413427044, 61531.94791593116]\n",
      "=====\n",
      "Delaware\n",
      "0.33379343756495683\n",
      "[0.06034782 0.00370495 0.11941958 0.04785793 1.37166802 0.05054912\n",
      " 0.80811048 0.04906239]\n",
      "0.33379343756495683\n",
      "[0.06034782 0.00370495 0.11941958 0.04785793 1.37166802 0.05054912\n",
      " 0.80811048 0.04906239]\n",
      "=====\n",
      "validation:\n",
      "[15356.14487956406, 15472.783347570083, 15586.167877315558, 15695.804217240555, 15801.629019167334, 15903.65095155566, 16002.175189334042, 16097.25231674654, 16189.066527282659, 16277.915365988822, 16363.939898709392, 16447.12867091727, 16527.664591871235, 16605.978693576348, 16682.236767607777, 16756.307277771837, 16827.999986630606, 16897.886144954948, 16966.16851979382, 17032.65042198328, 17097.51414540232, 17160.970496537444, 17223.008371214426, 17283.65697761149, 17343.11871923056, 17401.4787373352]\n",
      "prediction:\n",
      "[17458.656757815377, 17514.815854221568, 17570.00622771094, 17624.266977902502, 17677.68754049916, 17730.33591609091, 17782.244724604745, 17833.41121270755, 17883.854296599937, 17933.7189465601, 17983.071359020516, 18031.851217109222, 18080.00819409982, 18127.741458045555, 18175.132930677675, 18222.08222159824, 18268.46881353162, 18314.55588392016, 18360.46626704429, 18406.052449490053, 18451.105468299214, 18495.952294684746, 18540.718532508552, 18585.19507847947, 18629.282634695996, 18673.265271464094]\n",
      "=====\n",
      "Florida\n",
      "0.3575333716657281\n",
      "[0.07297802 0.05575173 0.15249321 0.07250519 1.41099427 0.04965439\n",
      " 0.7996553  0.02111807]\n",
      "0.3575333716657281\n",
      "[0.07297802 0.05575173 0.15249321 0.07250519 1.41099427 0.04965439\n",
      " 0.7996553  0.02111807]\n",
      "=====\n",
      "validation:\n",
      "[512138.29242161184, 519301.25711352564, 526195.9178610494, 532805.9998507025, 539117.5176129915, 545147.7478533362, 550908.6786832297, 556406.7526093373, 561664.241115837, 566694.2342812369, 571499.4070327099, 576092.424814802, 580498.1785588479, 584727.0419478723, 588773.2184860843, 592636.9360634093, 596349.2818973233, 599917.4025985624, 603332.299459296, 606610.6366075905, 609763.40484342, 612789.0103858662, 615692.4927221488, 618487.0806279341, 621176.902092357, 623758.7100332351]\n",
      "prediction:\n",
      "[626241.2873989495, 628630.505865746, 630929.2480619075, 633141.5887150194, 635273.0176944674, 637326.6947577597, 639303.3470428217, 641204.3999007415, 643037.7841817276, 644807.5485724213, 646511.611330739, 648150.1946744651, 649732.7813895779, 651262.4124278219, 652734.4637909794, 654149.9698263187, 655519.5432581438, 656844.8264514188, 658118.551295575, 659344.8221806653, 660532.761315541, 661681.0130031116, 662784.0561408505, 663850.0621724733, 664881.814568788, 665875.991612476]\n",
      "=====\n",
      "Georgia\n",
      "0.35875798327248704\n",
      "[0.07119991 0.00287451 0.18865713 0.07083574 1.49127513 0.06701122\n",
      " 0.77696893 0.11401845]\n",
      "0.35875798327248704\n",
      "[0.07119991 0.00287451 0.18865713 0.07083574 1.49127513 0.06701122\n",
      " 0.77696893 0.11401845]\n",
      "=====\n",
      "validation:\n",
      "[205944.7276009309, 209584.62414113636, 213088.98475160805, 216455.10054339535, 219683.3119028408, 222787.31744132948, 225779.87136227154, 228668.19063995953, 231467.3443016376, 234187.88765178967, 236834.71783427842, 239414.90368990504, 241942.33863479065, 244424.82734660603, 246862.77181533852, 249253.8209606049, 251612.41028223222, 253946.71005158682, 256252.99554843653, 258532.07897013583, 260794.46918068157, 263042.0067160767, 265270.5908183148, 267485.6093293554, 269693.5648195256, 271894.0060005806]\n",
      "prediction:\n",
      "[274081.5568534272, 276263.81082071865, 278441.356126751, 280613.6483630708, 282783.01462312625, 284951.0543457751, 287117.45048158785, 289280.1700983286, 291441.0888965491, 293604.753819854, 295771.2014310909, 297935.64127263986, 300096.03377585445, 302260.6576816505, 304430.86121727264, 306599.4623632719, 308765.1230546679, 310936.53537025716, 313113.7207241736, 315288.28290075646, 317461.17585852323, 319641.10250704066, 321827.0163065807, 324009.01431241434, 326189.707563705, 328378.4142079684]\n",
      "=====\n",
      "Hawaii\n",
      "3.257079928320217\n",
      "[1.05050375e-02 2.72301547e-03 9.00346456e-02 9.05179683e-02\n",
      " 2.78194577e+00 2.29847703e-01 3.56932304e-03 1.05187602e-01]\n",
      "3.257079090755123\n",
      "[1.05051619e-02 2.72295895e-03 9.00332139e-02 9.05160907e-02\n",
      " 2.78198205e+00 2.29852197e-01 3.56926062e-03 1.05189839e-01]\n",
      "3.2353580724171582\n",
      "[6.56043856e-03 1.50779850e-03 8.08263398e-02 8.19255432e-02\n",
      " 3.26221707e+00 2.86233912e-01 6.47339207e-03 1.82787502e-01]\n",
      "3.233951183088334\n",
      "[6.57663654e-03 1.49738968e-03 8.03373966e-02 8.13437044e-02\n",
      " 3.27995211e+00 2.88404279e-01 6.43834895e-03 1.84119912e-01]\n",
      "2.227090118771922\n",
      "[2.83282730e-02 5.86263850e-04 5.52111620e-02 1.00000000e-01\n",
      " 1.94514889e+00 7.23069160e-01 7.99470009e-03 4.51565259e-01]\n",
      "3.257083247502874\n",
      "[1.05051804e-02 2.72294907e-03 9.00334063e-02 9.05162778e-02\n",
      " 2.78197633e+00 2.29851476e-01 3.56925137e-03 1.05189512e-01]\n",
      "3.249710403177452\n",
      "[1.14752592e-02 2.71999056e-03 8.76358751e-02 8.82118695e-02\n",
      " 2.80690999e+00 2.33197166e-01 3.68078837e-03 1.06050154e-01]\n",
      "3.254506053899294\n",
      "[1.09995356e-02 2.72297894e-03 8.87179818e-02 8.92895557e-02\n",
      " 2.79645753e+00 2.31762590e-01 3.67179026e-03 1.05705620e-01]\n",
      "3.235994153437103\n",
      "[6.56016740e-03 1.51521282e-03 8.11349867e-02 8.22694343e-02\n",
      " 3.25115147e+00 2.84888601e-01 6.49199495e-03 1.81899711e-01]\n",
      "3.2171709883923016\n",
      "[6.69192911e-03 1.38730758e-03 7.54111282e-02 7.63538973e-02\n",
      " 3.47192878e+00 3.12004430e-01 6.62748498e-03 1.99517055e-01]\n",
      "2.227090118771922\n",
      "[2.83282730e-02 5.86263850e-04 5.52111620e-02 1.00000000e-01\n",
      " 1.94514889e+00 7.23069160e-01 7.99470009e-03 4.51565259e-01]\n",
      "=====\n",
      "validation:\n",
      "[2935.4565648669864, 3120.568159741156, 3309.824622465469, 3503.031121100385, 3699.9878144654554, 3900.489852139326, 4104.3273744597345, 4311.285512523511, 4521.144388186579, 4733.685675854992, 4949.036254042104, 5167.427988535472, 5388.986937841863, 5613.835917917133, 5842.094502166212, 6073.879021443117, 6309.302564050948, 6548.474975741886, 6791.502859717193, 7038.489576627219, 7289.537721968527, 7544.8873689109, 7804.784727710789, 8069.422971911491, 8338.999927557448, 8613.718073194254]\n",
      "prediction:\n",
      "[8893.783033996293, 9179.412554643639, 9470.782339878586, 9768.017183209762, 10071.393696538124, 10381.195672221567, 10697.704806343943, 11021.200698715054, 11351.960852870652, 11690.260676072445, 12036.373479308084, 12390.570477291185, 12753.120788461303, 13124.291434983954, 13504.347342750596, 13893.551341378652, 14292.164164211488, 14700.44444831842, 15118.648734494722, 15547.031467261615, 15985.844994866275, 16435.339569281823, 16895.76334620735, 17367.476926266307, 17851.034150524414, 18346.777751101246]\n",
      "=====\n",
      "Idaho\n",
      "0.8775546473872662\n",
      "[0.06852738 0.00519432 0.22985925 0.08766848 1.58829686 0.08014879\n",
      " 0.72292026 0.05088545]\n",
      "0.8775546473872662\n",
      "[0.06852738 0.00519432 0.22985925 0.08766848 1.58829686 0.08014879\n",
      " 0.72292026 0.05088545]\n",
      "=====\n",
      "validation:\n",
      "[23267.423844287838, 23849.646940438946, 24393.369047268214, 24900.52581945942, 25373.359858991666, 25816.62783598895, 26234.121215355175, 26629.017094364575, 27005.117600011763, 27365.086583624296, 27710.786984454026, 28044.747710037424, 28369.15692092454, 28685.370430591174, 28993.964025831727, 29296.237816402394, 29594.073034741206, 29888.25386170111, 30178.480506686647, 30465.393332349006, 30750.624042323594, 31034.617501668294, 31316.651213423498, 31596.951167730862, 31877.07330059191, 32157.31548907864]\n",
      "prediction:\n",
      "[32436.37117800882, 32715.412058721166, 32994.50919875451, 33273.64782728347, 33553.09487690556, 33833.02136011659, 34113.40176790139, 34394.01723642506, 34674.96520736804, 34956.81527400802, 35239.68121148895, 35523.14325295625, 35806.5712039127, 36090.77851442607, 36376.33986435948, 36662.81233614958, 36949.19515240544, 37236.364299631656, 37524.972194144306, 37814.56654048285, 38104.03222794082, 38394.2401154586, 38685.98586114753, 38978.83429399051, 39271.46851989762, 39564.687854352815]\n",
      "=====\n",
      "Illinois\n",
      "0.11975679346272163\n",
      "[0.08145681 0.00166662 0.13343571 0.07374005 1.00255777 0.06547539\n",
      " 0.94486989 0.09327197]\n",
      "0.11975679346272163\n",
      "[0.08145681 0.00166662 0.13343571 0.07374005 1.00255777 0.06547539\n",
      " 0.94486989 0.09327197]\n",
      "=====\n",
      "validation:\n",
      "[189474.6632754972, 191253.65833079064, 193046.10912504626, 194848.1960502574, 196659.97733068353, 198479.2886597666, 200308.87380198823, 202148.23227591516, 203994.07969852723, 205850.99961205927, 207722.59392864292, 209604.72442121044, 211490.60898352586, 213390.1415502851, 215304.10678771825, 217224.70504466194, 219158.5946417737, 221105.7312001853, 223061.2081194474, 225030.18470912325, 227014.0501700679, 229006.2944340671, 231007.50567897432, 233028.2571667872, 235064.78236504347, 237104.49134724727]\n",
      "prediction:\n",
      "[239157.22421655874, 241224.1662127254, 243304.43997276193, 245395.11855618918, 247499.86622288416, 249618.8439572139, 251747.27845854033, 253886.8523007927, 256043.35568253032, 258212.71006572637, 260386.3329406174, 262576.1377355695, 264786.30752788176, 267001.5070606389, 269224.12187315075, 271466.04193775344, 273716.5792060923, 275977.0684012955, 278252.9719706407, 280537.6517438483, 282832.9363128332, 285143.22662440094, 287463.2748325772, 289788.78332608193, 292130.80825503403, 294489.01446818066]\n",
      "=====\n",
      "Indiana\n",
      "0.2713777545907857\n",
      "[0.0774888  0.00187296 0.13506542 0.07692966 1.25001727 0.09935475\n",
      " 0.85689363 0.1189212 ]\n",
      "0.2713777545907857\n",
      "[0.0774888  0.00187296 0.13506542 0.07692966 1.25001727 0.09935475\n",
      " 0.85689363 0.1189212 ]\n",
      "=====\n",
      "validation:\n",
      "[71149.29172419666, 72063.02093372794, 72977.53081598971, 73889.62932078366, 74800.23749247515, 75709.17069884855, 76616.22475808495, 77523.08682714993, 78430.0170505491, 79335.75919428378, 80241.63366161246, 81150.69468784942, 82062.85016024054, 82974.72607439745, 83886.4581337822, 84803.0466764479, 85723.095873074, 86644.32986398958, 87570.0804852428, 88500.11520931462, 89432.697432737, 90370.00729913048, 91313.04195314136, 92260.12539998289, 93210.82791743496, 94167.45805797177]\n",
      "prediction:\n",
      "[95129.11811914129, 96096.15698006484, 97068.70553120345, 98046.72595136493, 99030.45246910416, 100020.21415771784, 101016.19965543057, 102018.45716539485, 103026.89445569113, 104041.27885932771, 105061.37949438738, 106088.28044401681, 107122.53040673674, 108162.7800320978, 109208.84656222486, 110262.47324337663, 111323.33696992746, 112389.13951902546, 113461.18130976605, 114542.67939318783, 115632.74849694186, 116726.46902905004, 117825.1145414665, 118933.56487925761, 120048.92681417304, 121168.88424587599]\n",
      "=====\n",
      "Iowa\n",
      "0.5035304770080546\n",
      "[0.08366329 0.00234836 0.03971122 0.06236028 1.63069083 0.36936284\n",
      " 0.74924771 0.08510537]\n",
      "0.5035304770080546\n",
      "[0.08366329 0.00234836 0.03971122 0.06236028 1.63069083 0.36936284\n",
      " 0.74924771 0.08510537]\n",
      "=====\n",
      "validation:\n",
      "[47713.91683948063, 48039.76745428867, 48376.89102881045, 48733.80123845407, 49114.156453774805, 49520.92087069647, 49955.18349830662, 50418.98177893121, 50913.37864781617, 51439.227562556305, 51998.09788524687, 52591.96180926315, 53221.11317118242, 53885.963505641186, 54588.06518291522, 55330.11104431958, 56114.15151198465, 56938.68431472097, 57803.98338601296, 58713.159078913624, 59670.01922290774, 60672.05489274568, 61718.29454877428, 62811.614037037245, 63956.42828354644, 65150.05988202374]\n",
      "prediction:\n",
      "[66393.23001641828, 67686.69911525812, 69032.0017774363, 70429.58734164624, 71876.8087476485, 73372.94890861058, 74919.38098383404, 76519.56837875448, 78175.70757988413, 79880.5533082908, 81631.69583165123, 83433.6267095952, 85286.6721091833, 87185.07456728729, 89128.08595182322, 91118.49701730645, 93153.59769181648, 95227.70316128244, 97339.46274436254, 99491.99484812352, 101685.48361402514, 103910.45934956073, 106163.04217406719, 108446.65945788284, 110765.48364847669, 113107.70432416981]\n",
      "=====\n",
      "Kansas\n",
      "1.1185791899021085\n",
      "[1.00000000e-05 2.07269504e-03 3.90915761e-02 3.97106951e-02\n",
      " 1.66362242e+00 9.05639567e-02 1.00000000e-02 6.03244396e-02]\n",
      "1.1185791899021085\n",
      "[1.00000000e-05 2.07269504e-03 3.90915761e-02 3.97106951e-02\n",
      " 1.66362242e+00 9.05639567e-02 1.00000000e-02 6.03244396e-02]\n",
      "=====\n",
      "validation:\n",
      "[28744.86967468675, 29089.379634285677, 29475.242054506038, 29898.334060117755, 30354.729836583025, 30840.700630056323, 31352.714747384394, 31887.437556106266, 32441.73148445323, 33012.656021348856, 33597.454536297475, 34193.99888005624, 34800.4997794674, 35415.23532239851, 36036.550935817315, 36662.85938579168, 37292.640777489636, 37924.44255517936, 38556.87950222919, 39188.6337411076, 39818.45473338324, 40445.15927972488, 41067.63151990147, 41684.82394612919, 42296.23380707774, 42901.51199446068]\n",
      "prediction:\n",
      "[43500.05424136189, 44091.32150798297, 44674.636239552674, 45248.908268875326, 45814.03573129828, 46370.01291466116, 46916.82305934281, 47454.43835826124, 47982.81995687365, 48501.91795317642, 49011.671397705104, 49512.008293534454, 50002.84559627839, 50484.08921409002, 50955.63400766162, 51417.36379022468, 51869.15132754983, 52310.858337946935, 52742.33549226499, 53163.4224138922, 53573.94767875595, 53973.728815322786, 54362.81721485859, 54742.152887304415, 55111.95993089277, 55472.366709007896]\n",
      "=====\n",
      "Kentucky\n",
      "0.5242765202581159\n",
      "[0.102112   0.00398209 0.1845235  0.06546881 1.48412458 0.06670978\n",
      " 0.76900124 0.06381097]\n",
      "0.5242765202581159\n",
      "[0.102112   0.00398209 0.1845235  0.06546881 1.48412458 0.06670978\n",
      " 0.76900124 0.06381097]\n",
      "=====\n",
      "validation:\n",
      "[33177.844915577785, 33793.362590527904, 34408.80030829715, 35021.6196545376, 35630.86629472609, 36236.4537520556, 36839.54157173669, 37439.95464348729, 38038.44104916538, 38636.20206005151, 39233.608528194054, 39830.19801092878, 40426.5666087575, 41024.926716586284, 41625.99999992214, 42228.8099530169, 42831.33817116055, 43436.221441536356, 44045.41190937522, 44657.4872881607, 45271.74746909659, 45890.226835630834, 46512.96236389683, 47138.97035517913, 47769.206421597766, 48404.28889826868]\n",
      "prediction:\n",
      "[49043.62355077795, 49687.67820385213, 50336.57283746084, 50990.470033874604, 51649.44519839574, 52313.541888282285, 52982.83394721907, 53657.42550531778, 54337.450979116926, 55023.0750715819, 55714.58231927552, 56411.679223889136, 57113.88407128232, 57821.431733490346, 58535.294280789974, 59256.35363520353, 59982.300231962116, 60712.06859989675, 61447.12829566587, 62190.852136394664, 62940.89487421773, 63694.72632016305, 64454.09843580202, 65221.172665740334, 65993.23239957355, 66770.09691114037]\n",
      "=====\n",
      "Louisiana\n",
      "0.3120321980214267\n",
      "[0.06893174 0.02134014 0.16367192 0.08454788 1.12409155 0.29530573\n",
      " 1.         0.04470199]\n",
      "0.3120321980214267\n",
      "[0.06893174 0.02134014 0.16367192 0.08454788 1.12409155 0.29530573\n",
      " 1.         0.04470199]\n",
      "=====\n",
      "validation:\n",
      "[127252.02833964158, 128633.7649053479, 129927.20256192496, 131143.32365417498, 132289.69835518266, 133373.02589794886, 134397.23921158136, 135369.1682592886, 136292.6251928347, 137168.89608133878, 138003.53921073212, 138803.14100639368, 139565.98936879972, 140295.85733471502, 140997.5804291428, 141670.4321391365, 142318.10148471664, 142942.9995017315, 143544.69476714125, 144126.37813453158, 144690.9075431989, 145235.9842934091, 145763.79418883045, 146279.11796632037, 146778.96176510316, 147264.97562793578]\n",
      "prediction:\n",
      "[147739.41724403264, 148201.7248048819, 148653.05557789296, 149094.0239793381, 149524.78196617155, 149946.38325879164, 150359.77721278675, 150764.13604622043, 151160.07838395616, 151549.61914402424, 151931.60967295847, 152305.84608002755, 152674.6021037345, 153036.73790751206, 153391.9650568894, 153742.44183765975, 154087.0129596511, 154425.22919538672, 154759.30619064183, 155088.1703183691, 155411.06643474326, 155730.2487895727, 156044.76990338386, 156353.7872201354, 156659.38056337673, 156960.60242354445]\n",
      "=====\n",
      "Maine\n",
      "0.298212088138854\n",
      "[0.08732902 0.00903572 0.07109347 0.03282478 1.23543269 0.03363941\n",
      " 0.87385697 0.039283  ]\n",
      "0.298212088138854\n",
      "[0.08732902 0.00903572 0.07109347 0.03282478 1.23543269 0.03363941\n",
      " 0.87385697 0.039283  ]\n",
      "=====\n",
      "validation:\n",
      "[4001.7234596933404, 4015.790312028227, 4030.4604658616922, 4045.6811750061206, 4061.468110630075, 4077.80314683838, 4094.711955378153, 4112.214009590013, 4130.302519895859, 4148.985745636584, 4168.316379872088, 4188.315925582401, 4208.966583871746, 4230.237822878304, 4252.212749892025, 4274.943261698412, 4298.38173998172, 4322.505693941349, 4347.428302001535, 4373.170427402826, 4399.654352709556, 4426.918840628855, 4455.085579062255, 4484.146306349163, 4513.999926841132, 4544.750530240279]\n",
      "prediction:\n",
      "[4576.42847070998, 4609.0468428214435, 4642.620634792542, 4677.167718721316, 4712.725487722316, 4749.321660239407, 4786.972190099109, 4825.681266510597, 4865.446310246481, 4906.3410338785725, 4948.432189411657, 4991.696520330832, 5036.053775293673, 5081.633589945394, 5128.56914677316, 5176.803120788852, 5226.16185194698, 5276.850641370784, 5329.020485025618, 5382.532168509048, 5437.299616293899, 5493.584600398063, 5551.411107801032, 5610.583178665051, 5671.214958511722, 5733.516554111437]\n",
      "=====\n",
      "Maryland\n",
      "0.14966425625449115\n",
      "[5.46976952e-02 8.32993952e-04 1.28092779e-01 4.91679486e-02\n",
      " 1.30861343e+00 1.18054710e-01 8.14338955e-01 1.40019216e-01]\n",
      "0.14966425625449115\n",
      "[5.46976952e-02 8.32993952e-04 1.28092779e-01 4.91679486e-02\n",
      " 1.30861343e+00 1.18054710e-01 8.14338955e-01 1.40019216e-01]\n",
      "=====\n",
      "validation:\n",
      "[93206.2402523036, 93969.18722410129, 94713.6640842685, 95438.98182317676, 96144.94516194912, 96833.47899234513, 97504.7332590427, 98160.02297079496, 98801.16997790437, 99428.88110364735, 100042.91639806695, 100644.95487878125, 101237.50376455963, 101821.17797806494, 102394.6377488481, 102957.36972318908, 103513.23726826547, 104062.87210026293, 104604.51666571788, 105139.87806643904, 105670.18890391628, 106194.94723916943, 106714.22657507847, 107229.5794411593, 107741.42876684022, 108248.99635368522]\n",
      "prediction:\n",
      "[108752.73354327542, 109253.5216274136, 109751.60538213224, 110246.85072458969, 110739.72043324324, 111230.79644224314, 111720.1915625431, 112207.54435007568, 112692.67907807928, 113176.86874634298, 113660.60551169666, 114143.07427451055, 114623.21005779802, 115102.99790801658, 115583.48577432624, 116063.4510698064, 116540.68394350135, 117017.86560220526, 117496.71405870255, 117975.47429439744, 118451.48382350431, 118928.13787742834, 119406.29896276639, 119883.59670571686, 120360.04083702301, 120837.56818152274]\n",
      "=====\n",
      "Massachusetts\n",
      "15.036208710750353\n",
      "[1.00000000e-05 2.35870611e-02 3.69646085e-01 1.19212269e-01\n",
      " 1.92598127e+00 1.21149361e-01 5.61853208e-01 7.29203605e-02]\n",
      "10084\n",
      "[2.24499202e-04 3.45110484e-02 3.37829931e-01 1.18431607e-01\n",
      " 1.84563368e+00 1.11527952e-01 6.05631775e-01 7.29280265e-02]\n",
      "10008\n",
      "[2.25773514e-04 3.42911814e-02 3.39342642e-01 1.19042542e-01\n",
      " 1.84940927e+00 1.11980609e-01 6.03918846e-01 7.33612160e-02]\n",
      "10029\n",
      "[2.79046996e-04 3.69143738e-02 3.37143701e-01 1.18498998e-01\n",
      " 1.84390091e+00 1.11327832e-01 6.06759900e-01 7.29727928e-02]\n",
      "12.65453414751704\n",
      "[1.00000000e-05 3.90146406e-02 3.03616107e-01 1.20077298e-01\n",
      " 1.75835652e+00 1.00978421e-01 6.51210821e-01 7.29203600e-02]\n",
      "15.047138608621484\n",
      "[1.00000000e-05 2.46879566e-02 3.68657210e-01 1.18662861e-01\n",
      " 1.92354521e+00 1.20858040e-01 5.62942361e-01 7.29203615e-02]\n",
      "0.37835429651652663\n",
      "[9.53914943e-03 1.80535476e-04 1.14972037e-01 4.04594670e-02\n",
      " 1.28971389e+00 4.47225818e-02 8.62746586e-01 7.09112714e-01]\n",
      "0.37835429651652663\n",
      "[9.53914943e-03 1.80535476e-04 1.14972037e-01 4.04594670e-02\n",
      " 1.28971389e+00 4.47225818e-02 8.62746586e-01 7.09112714e-01]\n",
      "=====\n",
      "validation:\n",
      "[120661.27467832167, 121220.75598277795, 121735.35742758829, 122207.031826534, 122637.68373317216, 123031.4926337511, 123391.70522697137, 123721.21889444589, 124023.59121517802, 124301.38301214195, 124556.41622712213, 124791.43570132843, 125008.97569617516, 125210.48248929676, 125396.54387062204, 125569.336873835, 125730.75618536067, 125881.31541952603, 126022.00000548964, 126154.24559300268, 126278.6986783675, 126395.87772408081, 126506.85092311104, 126612.2878282712, 126712.42704999406, 126807.86955336445]\n",
      "prediction:\n",
      "[126899.1803203628, 126986.74839345382, 127070.92078273333, 127152.0333826713, 127230.44044011166, 127306.42389182175, 127380.1904600731, 127451.8735965308, 127521.69346504535, 127589.98707439764, 127656.87862430119, 127722.32670338587, 127786.59642273109, 127849.89608539478, 127912.21536511024, 127973.53593439554, 128034.15978099359, 128094.22181711301, 128153.60022486033, 128212.22472877364, 128270.44787977674, 128328.33011652957, 128385.6581298021, 128442.58317018935, 128499.29278827205, 128555.70227748905]\n",
      "=====\n",
      "Michigan\n",
      "0.3920773628347381\n",
      "[0.00938479 0.006874   0.1        0.01       2.14979838 0.15276444\n",
      " 0.07796609 0.08076432]\n",
      "0.3920773628347381\n",
      "[0.00938479 0.006874   0.1        0.01       2.14979838 0.15276444\n",
      " 0.07796609 0.08076432]\n",
      "=====\n",
      "validation:\n",
      "[93480.23559296389, 94172.37938531375, 94929.22983704579, 95734.33348750207, 96573.58769654224, 97437.02874704657, 98316.39230632651, 99204.04856220812, 100093.00121943312, 100976.88749965894, 101849.98205970964, 102708.0594740214, 103549.07168383406, 104371.28520186566, 105173.0603419829, 105952.8512192013, 106709.20574968505, 107440.76565074708, 108146.3089399059, 108825.84901531684, 109479.9998746842, 110109.21724934559, 110713.9252791653, 111294.51651253432, 111851.35190637028, 112384.76082611753]\n",
      "prediction:\n",
      "[112894.75462029979, 113382.68068909511, 113848.97836895441, 114294.12789370633, 114719.26905314918, 115125.46048875652, 115513.6642733633, 115884.74591116575, 116239.4743377215, 116578.52191994949, 116902.46445613005, 117211.7811759048, 117506.85474027676, 117787.9712416103, 118055.54784581283, 118310.9019929033, 118554.76735913889, 118787.750703473, 119010.42481136971, 119223.32849480402, 119426.96659226163, 119621.80996873902, 119808.29551574348, 119986.82615129306, 120157.77081991661, 120321.46501767517]\n",
      "=====\n",
      "Minnesota\n",
      "0.37064196145769684\n",
      "[0.09263349 0.00765244 0.13935586 0.05931829 1.3886139  0.05469186\n",
      " 0.81061941 0.04313429]\n",
      "0.37064196145769684\n",
      "[0.09263349 0.00765244 0.13935586 0.05931829 1.3886139  0.05469186\n",
      " 0.81061941 0.04313429]\n",
      "=====\n",
      "validation:\n",
      "[58227.12920764457, 58921.8089785657, 59616.70258731605, 60308.8892789713, 60997.19631722443, 61681.11349890878, 62361.61702864431, 63038.21514490895, 63711.259718334564, 64381.93287897598, 65050.43374508701, 65716.00002488698, 66379.07087653075, 67041.58699095927, 67703.83184365838, 68364.21183566547, 69022.29928059367, 69681.04879359347, 70340.77170638714, 70999.05519684317, 71656.76876723018, 72316.23085930683, 72976.83674445543, 73636.3842855757, 74297.02167963565, 74960.03168272195]\n",
      "prediction:\n",
      "[75623.33928901459, 76288.07984514345, 76954.32976589318, 77621.91976892482, 78291.20062702536, 78962.58416240335, 79636.14605734256, 80311.62585420202, 80988.46097556653, 81667.10395766822, 82348.79487381158, 83033.28294933471, 83718.91360518351, 84406.42333465796, 85097.56224550749, 85791.83268535441, 86486.78297392376, 87183.49537938481, 87884.82718969704, 88590.13039631903, 89295.50754661293, 90002.37078632187, 90713.82340538895, 91428.30943846598, 92143.34206358987, 92861.74924132657]\n",
      "=====\n",
      "Mississippi\n",
      "0.5727266945895133\n",
      "[0.07838472 0.01216199 0.1352738  0.0770594  1.36389114 0.24880093\n",
      " 0.88415738 0.06048889]\n",
      "0.5727266945895133\n",
      "[0.07838472 0.01216199 0.1352738  0.0770594  1.36389114 0.24880093\n",
      " 0.88415738 0.06048889]\n",
      "=====\n",
      "validation:\n",
      "[64349.928623306056, 65209.34661591654, 66056.63046704154, 66892.02908852363, 67717.81203112852, 68533.90592084489, 69340.43543699465, 70139.1074317157, 70930.00002922807, 71711.74873319818, 72485.12233271322, 73252.98434000567, 74014.7502254748, 74768.09230649858, 75515.11250148126, 76257.73837381726, 76993.26676560962, 77722.36555780037, 78447.80271772327, 79167.4811136566, 79880.42455874418, 80589.31131899482, 81295.34230685364, 81994.64221016961, 82687.70354327917, 83378.92063982495]\n",
      "prediction:\n",
      "[84066.0043161124, 84748.3438132163, 85426.32338192867, 86100.77749920884, 86770.90819391033, 87436.6688772814, 88099.18527444897, 88758.74646726024, 89413.57689891792, 90063.89101938615, 90712.10501192766, 91357.41835130606, 91997.61550597067, 92634.33431693116, 93269.52805707311, 93900.180238044, 94526.36238845703, 95151.06682434828, 95772.50199197858, 96388.91557032202, 97002.61389765982, 97614.90137559312, 98222.36522118872, 98825.48598263905, 99427.76185841607, 100026.56413259625]\n",
      "=====\n",
      "Missouri\n",
      "0.5163352257202748\n",
      "[0.09740533 0.00397096 0.1761851  0.08542981 1.46877339 0.06488772\n",
      " 0.78196159 0.05482546]\n",
      "0.5163352257202748\n",
      "[0.09740533 0.00397096 0.1761851  0.08542981 1.46877339 0.06488772\n",
      " 0.78196159 0.05482546]\n",
      "=====\n",
      "validation:\n",
      "[56175.933690789054, 57383.47661083932, 58583.871345744235, 59773.99993903798, 60952.058615562164, 62119.37922847682, 63278.24063923459, 64428.579304996085, 65573.00939607028, 66713.89643851349, 67851.7944980954, 68985.85049624511, 70119.58702836104, 71256.98735222082, 72398.27110899873, 73539.87189202708, 74681.54259554576, 75830.47327144296, 76986.64064044293, 78146.26071531154, 79313.31885861953, 80489.14990688703, 81671.999999399, 82862.81280899109, 84064.14894975138, 85276.0044641319]\n",
      "prediction:\n",
      "[86495.92655379734, 87726.6913534948, 88968.34840188382, 90220.76542911815, 91484.9066929197, 92761.31069316668, 94049.7829556602, 95349.3831473434, 96660.5140241271, 97985.7566481921, 99325.3613287174, 100676.83233378455, 102038.204612002, 103414.37345653586, 104806.70627945103, 106210.95569800452, 107624.79849523555, 109054.7039791155, 110501.4598275498, 111959.02557685955, 113426.36611948237, 114910.95881229742, 116412.511878458, 117923.15393075168, 119444.8620085948, 120984.42663802949]\n",
      "=====\n",
      "Montana\n",
      "1.7408430681276248\n",
      "[0.11477362 0.00914436 0.22839865 0.07417754 1.55368663 0.07749132\n",
      " 0.74272791 0.04498862]\n",
      "1.7408430681276248\n",
      "[0.11477362 0.00914436 0.22839865 0.07417754 1.55368663 0.07749132\n",
      " 0.74272791 0.04498862]\n",
      "=====\n",
      "validation:\n",
      "[4578.790294496182, 4696.676966669843, 4813.587231475796, 4929.178177789386, 5043.309023862843, 5156.144478990475, 5267.974376203973, 5378.843869793864, 5489.048753895395, 5598.85316934463, 5708.35533253695, 5817.543949848428, 5926.741880351255, 6036.279161703742, 6146.223031755753, 6256.377007245435, 6366.66656477526, 6477.671291312762, 6589.5327493139175, 6701.927112411384, 6814.966988418535, 6928.997074567116, 7043.99040220984, 7159.740598826971, 7276.493820795955, 7394.386898748446]\n",
      "prediction:\n",
      "[7513.272163974777, 7633.264124115942, 7754.38773937352, 7876.662457784148, 8000.124641468621, 8124.805940063356, 8250.729263133468, 8377.908780172771, 8506.34992060379, 8636.043156331667, 8766.991366533435, 8899.312942418275, 9033.049660751518, 9168.1388255718, 9304.395285023951, 9441.78380997961, 9580.808999075922, 9721.610788803962, 9863.853517790807, 10006.85125705157, 10151.136535482921, 10297.219531446155, 10444.71791940781, 10593.309017324189, 10743.450646486188, 10895.116049259068]\n",
      "=====\n",
      "Nebraska\n",
      "0.43153154682264233\n",
      "[0.06667921 0.00192908 0.12836591 0.05818145 1.34183928 0.04981051\n",
      " 0.84200979 0.05121185]\n",
      "0.43153154682264233\n",
      "[0.06667921 0.00192908 0.12836591 0.05818145 1.34183928 0.04981051\n",
      " 0.84200979 0.05121185]\n",
      "=====\n",
      "validation:\n",
      "[27630.026035921226, 27908.38145675651, 28185.653233589066, 28460.93312107299, 28733.702927211594, 29003.94533631954, 29272.00806794907, 29537.663330218355, 29801.20585049397, 30063.078666714602, 30323.27646555131, 30581.45365480512, 30838.10231812323, 31093.88380175983, 31348.648399587255, 31601.603649404173, 31853.425929812987, 32104.94845281067, 32355.704481062716, 32604.958677206636, 32853.871892635834, 33102.72026298156, 33350.631269495665, 33597.679380859016, 33844.91373444548, 34092.175583240256]\n",
      "prediction:\n",
      "[34338.40686228797, 34584.60517094702, 34830.80292384574, 35076.66313670772, 35322.468166813655, 35568.4553644227, 35814.448478047874, 36060.04169458794, 36305.74364286461, 36551.99543687313, 36798.456115379624, 37044.32584042408, 37290.40065844537, 37537.24193745892, 37784.168342717385, 38030.61327223299, 38277.679903713026, 38525.448705696945, 38772.915852489394, 39020.322751157466, 39268.60530813858, 39517.43383890407, 39765.6721777682, 40014.24234382178, 40263.852447188365, 40513.71713032836]\n",
      "=====\n",
      "Nevada\n",
      "0.6263873379558688\n",
      "[0.07375952 0.01018366 0.18948947 0.06898868 1.50620759 0.06904969\n",
      " 0.7545358  0.0463743 ]\n",
      "0.6263873379558688\n",
      "[0.07375952 0.01018366 0.18948947 0.06898868 1.50620759 0.06904969\n",
      " 0.7545358  0.0463743 ]\n",
      "=====\n",
      "validation:\n",
      "[53523.71667711502, 54465.33917729775, 55367.467493908174, 56228.56806219202, 57049.04074979953, 57832.03224186356, 58581.38279926127, 59298.98955458436, 59988.77164411282, 60653.82142978594, 61295.80197140413, 61916.358058123, 62518.99426825928, 63106.07464222034, 63678.31338353871, 64235.22854820109, 64779.633150155496, 65314.220503900084, 65839.06931056516, 66353.3473690764, 66859.71515636967, 67359.429837644, 67852.00000155531, 68337.39798401907, 68817.7045613159, 69293.66086837706]\n",
      "prediction:\n",
      "[69763.92761880021, 70229.929999021, 70691.93526045202, 71150.04335525968, 71604.76937515213, 72056.53186088415, 72505.46148948064, 72951.40107423658, 73394.15040349161, 73834.6054086042, 74273.37625804718, 74710.08928686507, 75143.67247424244, 75575.07048889872, 76005.57407034299, 76434.87154318386, 76861.14720849972, 77284.72850136022, 77707.98298438618, 78130.93179823206, 78551.10885460013, 78968.17915963623, 79385.00400050069, 79801.55471112423, 80215.3232381571, 80627.06596172976]\n",
      "=====\n",
      "New Hampshire\n",
      "0.2723583619569488\n",
      "[1.00000000e-05 1.21031016e-02 1.00000000e-01 5.70829062e-03\n",
      " 2.00123741e+00 1.39868781e-01 1.00000000e-01 6.76209796e-02]\n",
      "0.2723583619569488\n",
      "[1.00000000e-05 1.21031016e-02 1.00000000e-01 5.70829062e-03\n",
      " 2.00123741e+00 1.39868781e-01 1.00000000e-01 6.76209796e-02]\n",
      "=====\n",
      "validation:\n",
      "[6697.510302591154, 6722.284253078902, 6748.949707860962, 6776.845008115094, 6805.46156912916, 6834.4455464750245, 6863.483100214712, 6892.2906949626495, 6920.615099885666, 6948.233686817381, 6974.993943720765, 7000.835298673017, 7025.70899875447, 7049.569830559148, 7072.376120194776, 7094.089733282769, 7114.676218941523, 7134.134918663901, 7152.512025772531, 7169.850389812695, 7186.188501361277, 7201.560492026774, 7215.996134449286, 7229.52084230052, 7242.15567028379, 7253.943105086465]\n",
      "prediction:\n",
      "[7264.944271084869, 7275.200373591036, 7284.74414798502, 7293.615645194385, 7301.8620140682815, 7309.526479881179, 7316.648344332871, 7323.262985548467, 7329.401858078402, 7335.092492898428, 7340.358497409618, 7345.219555438367, 7349.697266543799, 7353.8317498503975, 7357.649194326682, 7361.172592173187, 7364.423426222707, 7367.42166994031, 7370.185787423323, 7372.732733401343, 7375.077953236231, 7377.235382922116, 7379.219173594312, 7381.044104016115, 7382.7220458026195, 7384.264163048305]\n",
      "=====\n",
      "New Jersey\n",
      "10001\n",
      "[4.59177085e-04 3.73563967e-02 4.37044549e-02 5.00255238e-03\n",
      " 1.87416827e+00 1.14908495e-01 9.05153034e-02 8.68440748e-02]\n",
      "0.10808058522271008\n",
      "[1.00000000e-05 7.61151533e-04 1.00000000e-01 3.39166438e-03\n",
      " 1.80080055e+00 1.11721950e-01 9.97186276e-02 1.21211456e-01]\n",
      "0.10808058522271008\n",
      "[1.00000000e-05 7.61151533e-04 1.00000000e-01 3.39166438e-03\n",
      " 1.80080055e+00 1.11721950e-01 9.97186276e-02 1.21211456e-01]\n",
      "=====\n",
      "validation:\n",
      "[183258.2220988993, 183619.2145042493, 184009.2275178829, 184418.4887421494, 184839.40898601373, 185266.7265559195, 185695.77502557173, 186122.31939371553, 186542.55608413613, 186953.11301341365, 187351.503515568, 187736.74506881257, 188108.10109714378, 188464.88535831333, 188806.46194382824, 189132.24527895075, 189441.7001226985, 189734.57191270255, 190011.45658673078, 190272.99198469182, 190519.74979932985, 190752.2389083769, 190970.9053745526, 191176.13244556458, 191368.2405541081, 191547.61300175622]\n",
      "prediction:\n",
      "[191715.19151976015, 191871.628841235, 192017.39514332695, 192153.07287508558, 192279.35547462836, 192396.87907503042, 192506.2225043243, 192607.90728550017, 192702.3976365056, 192790.1004702459, 192871.36539458367, 192946.48471233924, 193015.77379392553, 193079.82979520154, 193139.04856120466, 193193.77541417416, 193244.33318875747, 193291.0222320102, 193334.1204033963, 193373.8830747878, 193410.543130465, 193444.31096711647, 193475.3982878998, 193504.03141862503, 193530.39164365496, 193554.64912975807]\n",
      "=====\n",
      "New Mexico\n",
      "0.2337390709464754\n",
      "[0.0702043  0.00744475 0.14838448 0.04534437 1.40895039 0.05673766\n",
      " 0.7972841  0.05603769]\n",
      "0.2337390709464754\n",
      "[0.0702043  0.00744475 0.14838448 0.04534437 1.40895039 0.05673766\n",
      " 0.7972841  0.05603769]\n",
      "=====\n",
      "validation:\n",
      "[21704.341771953572, 21904.318259324693, 22098.951265484146, 22287.480641879498, 22469.73952712465, 22645.873911084924, 22816.420934560076, 22981.475723386306, 23141.477103682264, 23296.926189510057, 23448.047389208594, 23594.847410951395, 23737.815928897362, 23877.58173159104, 24014.33483478729, 24147.817128227234, 24277.960309181904, 24405.69422238372, 24531.225842875596, 24654.193143569573, 24774.970736486306, 24893.914129774108, 25010.973216206556, 25126.120941041117, 25239.742297449186, 25351.99999321209]\n",
      "prediction:\n",
      "[25462.680629082042, 25572.05852402399, 25680.207494417118, 25787.16004648216, 25893.042011516263, 25997.9685254025, 26101.99329281767, 26205.108587232316, 26307.263921943086, 26408.62156498697, 26509.388038527246, 26609.532641531354, 26708.832098556595, 26807.467789430855, 26905.715298151845, 27003.52462366619, 27100.565518582127, 27196.99937947715, 27293.251421886915, 27389.285306366666, 27484.605823705795, 27579.248438665138, 27673.843167350497, 27768.37720694157, 27862.22130385676, 27955.543268569316]\n",
      "=====\n",
      "New York\n",
      "0.06494265006196953\n",
      "[1.04198234e-05 1.17689626e-03 9.38526017e-02 1.94578060e-03\n",
      " 2.48346832e+00 1.91318230e-01 9.45360931e-02 9.46680127e-02]\n",
      "0.06494265006196953\n",
      "[1.04198234e-05 1.17689626e-03 9.38526017e-02 1.94578060e-03\n",
      " 2.48346832e+00 1.91318230e-01 9.45360931e-02 9.46680127e-02]\n",
      "=====\n",
      "validation:\n",
      "[417986.598615745, 418640.81354831625, 419348.2034287726, 420092.6148211674, 420860.21356696193, 421641.41763859865, 422428.6466106046, 423214.9456110806, 423993.9793571158, 424760.0321547865, 425508.0082771217, 426234.20070221374, 426937.2235474966, 427616.0308238768, 428269.63940513734, 428897.12902793754, 429497.64229181304, 430070.38465917605, 430614.67763628066, 431131.05461326224, 431620.60934093955, 432084.2693035198, 432522.88951807574, 432937.25253454584, 433328.06843573396, 433695.97483730974]\n",
      "prediction:\n",
      "[434041.2182802625, 434365.49689432903, 434669.5169711246, 434954.2103791003, 435220.80443811347, 435470.4273512549, 435704.1082044955, 435922.77696668636, 436127.26448955893, 436318.30250772473, 436496.52363867563, 436662.4613827837, 436816.5501233013, 436959.6052316617, 437092.66614170215, 437216.39186583424, 437331.4019108693, 437438.2762818668, 437537.555482135, 437629.7405132303, 437715.2928749581, 437794.6345653718, 437868.14808077365, 437936.2094402877, 437999.2598807798, 438057.65051684185]\n",
      "=====\n",
      "North Carolina\n",
      "0.8803687356607444\n",
      "[0.07828952 0.00294319 0.15127187 0.0531176  1.40353844 0.05667705\n",
      " 0.81058712 0.07940302]\n",
      "0.8803687356607444\n",
      "[0.07828952 0.00294319 0.15127187 0.0531176  1.40353844 0.05667705\n",
      " 0.81058712 0.07940302]\n",
      "=====\n",
      "validation:\n",
      "[130326.01134721244, 131849.8284652485, 133370.81309397268, 134882.627425703, 136382.43795539206, 137869.48361043647, 139345.91424314678, 140810.63489955533, 142264.85540180322, 143711.06736395555, 145149.5955197938, 146578.8242556798, 148000.355646837, 149418.13849440817, 150832.51243255232, 152239.96776496767, 153639.9999881283, 155038.8346620769, 156436.92347269497, 157829.13441526238, 159217.6298520008, 160606.90392826442, 161995.5434638207, 163379.25246481659, 164762.45447428335, 166147.49424301094]\n",
      "prediction:\n",
      "[167530.17592905872, 168912.78202055546, 170295.43599379348, 171677.72338042193, 173060.2474486425, 174443.87634122575, 175828.76549368064, 177214.3564669708, 178599.41451213945, 179984.50229214117, 181372.2965444554, 182762.53899895897, 184151.87330766168, 185541.07545621778, 186933.87731898273, 188329.66642491778, 189723.7316723115, 191117.14015695927, 192515.73545196408, 193918.93565974996, 195319.57927061556, 196718.53697440788, 198122.6285596388, 199529.92131832102, 200934.50950219992, 202341.36457771983]\n",
      "=====\n",
      "North Dakota\n",
      "1.2608317257060038\n",
      "[0.11513193 0.00409894 0.17189241 0.06779763 1.46165118 0.06335956\n",
      " 0.78181722 0.05674929]\n",
      "1.2608317257060038\n",
      "[0.11513193 0.00409894 0.17189241 0.06779763 1.46165118 0.06335956\n",
      " 0.78181722 0.05674929]\n",
      "=====\n",
      "validation:\n",
      "[7083.608985651972, 7222.403746464427, 7365.351402347546, 7511.792210561664, 7661.481159682026, 7814.168777819866, 7969.999990968814, 8128.850681622876, 8290.602945149782, 8455.445469819382, 8623.4217405202, 8794.382097747084, 8968.079105529217, 9144.810267180039, 9324.847107228337, 9508.022746110533, 9693.764603137195, 9882.198093831452, 10073.969065411136, 10268.933478982744, 10466.292370663485, 10666.401702862096, 10869.795620152883, 11076.169393060034, 11284.862450481365, 11496.404122526546]\n",
      "prediction:\n",
      "[11710.725437327324, 11927.761861310548, 12147.475917603053, 12369.887185637153, 12594.85003971474, 12822.24631883399, 13052.029676226182, 13284.225579355701, 13518.93130992004, 13756.245661696037, 13995.757136716438, 14237.173993411761, 14480.799649308285, 14726.959734165514, 14974.988197943836, 15224.690000890232, 15476.502769089278, 15730.701409909761, 15986.342022252154, 16243.107587896899, 16501.625743579283, 16762.687775846025, 17024.99259047545, 17288.11197642482, 17552.93375948461, 17819.567548188963]\n",
      "=====\n",
      "Ohio\n",
      "0.31132482071288814\n",
      "[0.07829629 0.00291123 0.1487388  0.05547443 1.39697833 0.18532984\n",
      " 0.83212564 0.1068231 ]\n",
      "0.31132482071288814\n",
      "[0.07829629 0.00291123 0.1487388  0.05547443 1.39697833 0.18532984\n",
      " 0.83212564 0.1068231 ]\n",
      "=====\n",
      "validation:\n",
      "[97470.99998812855, 98597.19990039745, 99706.88902220696, 100801.33513662615, 101880.71166615043, 102945.31189372504, 103997.5956739068, 105038.25412435114, 106066.65541498896, 107085.21582402296, 108096.61702268208, 109100.97740230543, 110095.98131879763, 111083.08518073593, 112066.59402404538, 113046.00716271235, 114018.40485693378, 114987.54307924228, 115955.02209438517, 116918.7721974563, 117878.73716335956, 118838.47228500972, 119798.20920843196, 120754.96607606931, 121710.2543443976, 122666.78226761913]\n",
      "prediction:\n",
      "[123622.6774141163, 124578.93070157166, 125535.8035290714, 126493.17135956214, 127451.35039906303, 128411.22822437354, 129373.20935920841, 130337.19450397324, 131302.58053576422, 132268.57471484365, 133236.91432072452, 134208.9487135564, 135183.0972899621, 136158.49263601936, 137137.4066618179, 138119.8003568942, 139103.674957428, 140089.93793207817, 141080.95525261664, 142076.25778704515, 143072.60778698535, 144070.6758635061, 145074.1850461295, 146082.1217762384, 147090.5356774933, 148102.6080433627]\n",
      "=====\n",
      "Oklahoma\n",
      "0.6409067024631403\n",
      "[0.08805869 0.00465556 0.18603025 0.07405354 1.47423171 0.06662635\n",
      " 0.77819918 0.05474484]\n",
      "0.6409067024631403\n",
      "[0.08805869 0.00465556 0.18603025 0.07405354 1.47423171 0.06662635\n",
      " 0.77819918 0.05474484]\n",
      "=====\n",
      "validation:\n",
      "[40890.33327690615, 41685.03987402401, 42467.6484849025, 43236.14233020717, 43989.534264731796, 44729.041880444594, 45456.4623100365, 46172.04952258206, 46877.84146866002, 47575.52482234507, 48265.61338458813, 48947.97983707918, 49625.135388706374, 50299.23102551923, 50970.373730598156, 51636.673471572845, 52298.98435521735, 52960.96005431342, 53622.458672071996, 54281.50975874805, 54940.50630694467, 55600.3322775304, 56259.9994410151, 56919.78028304067, 57581.362754292946, 58244.926187916455]\n",
      "prediction:\n",
      "[58908.8678811192, 59574.77558912581, 60242.7189187589, 60912.54972904333, 61584.77367284028, 62259.75555628244, 62937.43822245365, 63617.33928644137, 64299.30112206508, 64984.71391893171, 65673.98256907056, 66366.03074361777, 67059.06292654792, 67755.46570278442, 68457.34306016637, 69163.32016882658, 69869.3398104457, 70578.0211276328, 71291.98369481553, 72009.11454435956, 72727.79657710998, 73450.58727595012, 74177.29231025935, 74906.06116501379, 75637.90321139967, 76373.9507943917]\n",
      "=====\n",
      "Oregon\n",
      "0.521060738968187\n",
      "[0.07520015 0.00622865 0.16982422 0.07178028 1.44876977 0.06262205\n",
      " 0.78874248 0.04976967]\n",
      "0.521060738968187\n",
      "[0.07520015 0.00622865 0.16982422 0.07178028 1.44876977 0.06262205\n",
      " 0.78874248 0.04976967]\n",
      "=====\n",
      "validation:\n",
      "[20236.346800330342, 20567.242542902473, 20889.582892025428, 21202.723079799507, 21506.4136816325, 21801.386707372545, 22088.534084590392, 22368.136025178632, 22641.221765925085, 22908.59195288579, 23170.552613043772, 23427.264499934638, 23679.926344076568, 23929.384633856665, 24175.680868987987, 24418.159287121016, 24657.70393989815, 24895.5390745529, 25131.439751322505, 25365.026807722876, 25597.33693628543, 25828.584256377144, 26058.418756415762, 26287.27382350759, 26515.71691407112, 26743.72278790871]\n",
      "prediction:\n",
      "[26970.84373453448, 27197.754843566792, 27424.532280324835, 27651.111485060967, 27877.732680662586, 28104.595701893115, 28331.691261437376, 28558.81022286918, 28786.07456901841, 29014.02467255488, 29242.711339614838, 29471.625203825137, 29700.577782511264, 29930.47217600792, 30161.44305260779, 30392.690840564286, 30624.122463445834, 30856.765945251835, 31090.615116588793, 31324.645210969386, 31559.06015291119, 31794.911987696647, 32032.002090904272, 32269.13649703461, 32506.95321147877, 32746.327794098026]\n",
      "=====\n",
      "Pennsylvania\n",
      "0.1423731744557998\n",
      "[1.00000000e-05 4.52211455e-03 3.72402999e-03 5.86017314e-02\n",
      " 1.68718783e+00 1.23498644e-01 9.98178797e-03 8.63915793e-02]\n",
      "0.1423731744557998\n",
      "[1.00000000e-05 4.52211455e-03 3.72402999e-03 5.86017314e-02\n",
      " 1.68718783e+00 1.23498644e-01 9.98178797e-03 8.63915793e-02]\n",
      "=====\n",
      "validation:\n",
      "[121338.80740996194, 122134.95754320682, 122920.17104524327, 123694.72115186026, 124458.89726134969, 125213.0049345064, 125957.36589462816, 126692.31802751572, 127418.21538147269, 128135.4281673057, 128844.34275832423, 129545.3616903408, 130238.90366167076, 130925.40353313246, 131605.31232804718, 132279.09723223915, 132947.24159403547, 133610.24492426627, 134268.62289626454, 134922.90734586623, 135573.64627141028, 136220.4652025418, 136862.69125940686, 137500.48537001404, 138133.9999474496, 138763.3787940919]\n",
      "prediction:\n",
      "[139388.75791989604, 140010.26112626557, 140628.0061401043, 141242.28454095905, 141853.4595057357, 142461.5088385145, 143066.40920901578, 143668.14432207384, 144266.70491763734, 144862.0887707689, 145454.30069164533, 146043.35252555768, 146629.2631529111, 147212.05848922482, 147791.7714851323, 148368.4421263811, 148942.11743383296, 149512.8514634637, 150080.7053063634, 150645.74708873616, 151208.05197190034, 151767.70215228834, 152324.78686144683, 152879.40236603652, 153431.6519678323, 153981.6460037232]\n",
      "=====\n",
      "Rhode Island\n",
      "6.045246258494237\n",
      "[1.00000000e-05 1.28171356e-02 2.96003497e-01 9.62706104e-02\n",
      " 1.74209518e+00 9.92762996e-02 6.48098299e-01 5.29669204e-02]\n",
      "0.2609175512241692\n",
      "[0.09945036 0.00679954 0.15168323 0.02407717 1.51971473 0.06421972\n",
      " 0.74329649 0.06003126]\n",
      "0.2609175512241692\n",
      "[0.09945036 0.00679954 0.15168323 0.02407717 1.51971473 0.06421972\n",
      " 0.74329649 0.06003126]\n",
      "=====\n",
      "validation:\n",
      "[19419.02723006315, 19540.52884675051, 19660.984194744226, 19779.325547433436, 19895.420988952064, 20008.92883043424, 20120.018139716438, 20228.737915809532, 20334.999945555188, 20438.990727376415, 20540.85729027809, 20640.61746798873, 20738.174585994653, 20833.677986496168, 20927.44758095538, 21019.588609602877, 21109.978943935967, 21198.328404744017, 21284.962423532867, 21370.231927293265, 21454.077182427547, 21536.24997256103, 21617.036691234855, 21696.577814663735, 21774.81504084458, 21851.724321317968]\n",
      "prediction:\n",
      "[21927.44744325366, 22002.021170241795, 22075.48051481451, 22147.833544626523, 22219.163410544606, 22289.544522323304, 22359.01553313555, 22427.57933957267, 22495.20308164441, 22561.877469174186, 22627.77217564547, 22692.97612241014, 22757.428083751183, 22821.024409266596, 22883.937966068195, 22946.255697649074, 23007.936286658496, 23068.86406000729, 23129.171851702173, 23189.00823499181, 23248.369827842478, 23307.101244958372, 23365.1464446946, 23422.763112128105, 23480.017011572007, 23536.76906113373]\n",
      "=====\n",
      "South Carolina\n",
      "0.4056267194991211\n",
      "[0.10564004 0.03855509 0.18128341 0.06337353 1.05215811 0.3661892\n",
      " 0.95278754 0.02952036]\n",
      "0.4056267194991211\n",
      "[0.10564004 0.03855509 0.18128341 0.06337353 1.05215811 0.3661892\n",
      " 0.95278754 0.02952036]\n",
      "=====\n",
      "validation:\n",
      "[97083.196249075, 98124.32646857946, 99137.36619972008, 100127.35470534267, 101096.09731377984, 102045.14864626006, 102974.04976123059, 103884.69618123697, 104777.26941421219, 105650.51518797435, 106505.73297740545, 107345.80360216413, 108168.47071148254, 108972.92670547133, 109763.00408894522, 110537.8320652757, 111295.16233934982, 112038.24651694731, 112768.29423379687, 113481.62616880046, 114180.26211036001, 114868.01929076873, 115540.44876555467, 116197.93861017712, 116845.02231618411, 117478.59476742946]\n",
      "prediction:\n",
      "[118099.44955584401, 118708.00885594316, 119304.54285593632, 119889.28719641756, 120462.49306946712, 121024.40373675228, 121575.24245918571, 122115.21249692535, 122644.49704214948, 123163.2131942392, 123671.80412553718, 124170.58005508973, 124659.41418781457, 125137.94038363428, 125607.47580395828, 126068.68640871187, 126520.39210073138, 126961.93576988443, 127395.75385588156, 127821.28668619558, 128237.44168659687, 128646.04439739331, 129046.72689743826, 129438.69991618712, 129823.54868623626, 130201.30262888515]\n",
      "=====\n",
      "South Dakota\n",
      "1.1558438601561765\n",
      "[0.09927449 0.00141985 0.08868502 0.05901369 1.25043982 0.03653335\n",
      " 0.89405391 0.10070733]\n",
      "1.1558438601561765\n",
      "[0.09927449 0.00141985 0.08868502 0.05901369 1.25043982 0.03653335\n",
      " 0.89405391 0.10070733]\n",
      "=====\n",
      "validation:\n",
      "[9183.439358079706, 9263.05534371713, 9348.706325168772, 9440.273309030923, 9537.85819826626, 9641.414714556824, 9751.149462419544, 9867.167597470709, 9989.416798516673, 10117.999977144154, 10253.285750704026, 10395.38475144867, 10544.113200319194, 10699.207555674138, 10861.301515079185, 11030.672409416258, 11206.760066355666, 11389.715008431433, 11580.097931784578, 11777.653488423923, 11981.92742094096, 12193.63754335536, 12412.982426005381, 12639.267312219132, 12872.401656718266, 13113.105506593674]\n",
      "prediction:\n",
      "[13360.891556139662, 13615.824807053712, 13877.908948472432, 14147.12843886077, 14423.142965866806, 14705.78846960517, 14995.113685618677, 15291.38013807622, 15594.615151475382, 15903.803213208306, 16218.827552182722, 16540.601640758934, 16868.283734558572, 17201.082536948383, 17539.630911427783, 17884.21788502833, 18233.20600187154, 18586.377476955924, 18945.211466032444, 19309.08573644267, 19675.617111429092, 20045.366420688108, 20420.823967950557, 20799.277299422854, 21179.191096828938, 21562.85088158103]\n",
      "=====\n",
      "Tennessee\n",
      "0.5037235579888417\n",
      "[0.07926499 0.00385504 0.18558484 0.06357638 1.46851096 0.06588862\n",
      " 0.77675317 0.05805659]\n",
      "0.5037235579888417\n",
      "[0.07926499 0.00385504 0.18558484 0.06357638 1.46851096 0.06588862\n",
      " 0.77675317 0.05805659]\n",
      "=====\n",
      "validation:\n",
      "[116127.89933283288, 118042.58442306228, 119913.89797427625, 121736.76049661743, 123509.41216064224, 125235.20470933178, 126919.27996379393, 128562.87426394221, 130171.42187754546, 131749.49108672235, 133298.83301834489, 134819.91974346098, 136318.85899986845, 137800.57667447222, 139265.70334450892, 140710.74911658815, 142138.4307740044, 143556.44545691326, 144964.88166547677, 146359.66791431233, 147745.95902637896, 149126.34833730245, 150499.0909085055, 151863.87432053848, 153224.88423584873, 154583.19483128493]\n",
      "prediction:\n",
      "[155935.26023307524, 157284.27538134312, 158630.53505277203, 159973.88023174676, 161315.32400284085, 162655.7063805811, 163995.11155045987, 165332.8678689348, 166668.1402095448, 168003.20430652416, 169339.6380651364, 170676.16355485347, 172009.32036387542, 173341.60808912976, 174677.28914401997, 176015.29427987075, 177349.52361773627, 178681.57993835717, 180017.1499432788, 181354.67812546185, 182688.61228646815, 184023.1149559787, 185360.2867888811, 186697.3183540482, 188031.86969908813, 189368.0702598173]\n",
      "=====\n",
      "Texas\n",
      "2.2313108345852344\n",
      "[0.0712851  0.00618423 0.19955812 0.07092811 1.51743968 0.0703901\n",
      " 0.75850115 0.09003135]\n",
      "0.8593398320463996\n",
      "[0.10965845 0.1089623  0.18223498 0.06740596 1.48487675 0.08129893\n",
      " 0.76397668 0.02210304]\n",
      "0.8593398320463996\n",
      "[0.10965845 0.1089623  0.18223498 0.06740596 1.48487675 0.08129893\n",
      " 0.76397668 0.02210304]\n",
      "=====\n",
      "validation:\n",
      "[477379.3509928203, 486009.8148906596, 494489.8666862018, 502765.7369017305, 510821.67302286293, 518642.317395289, 526239.3320057853, 533607.1550323756, 540745.6495036198, 547669.5552716836, 554383.0683049542, 560878.6215792106, 567154.907829134, 573241.4025009319, 579150.7218544898, 584871.2771548387, 590375.6659263228, 595696.73321759, 600856.8231235965, 605841.0092128423, 610650.6509195685, 615303.6071314351, 619799.8314760466, 624136.4893768245, 628326.6994589077, 632377.2548725776]\n",
      "prediction:\n",
      "[636283.0652916384, 640053.4398338299, 643691.0033923016, 647199.6453994553, 650587.1102048183, 653858.3454492487, 657015.2709865285, 660056.778883364, 662983.7508070897, 665809.0334360016, 668537.6161702501, 671164.8238586884, 673695.2928359131, 676137.23749378, 678491.6817621858, 680756.7379399652, 682940.036520456, 685047.6141423298, 687079.5265931792, 689031.6847022527, 690911.6180404492, 692726.9351758548, 694476.8270399863, 696156.6653181392, 697775.347447391, 699338.2786356929]\n",
      "=====\n",
      "Utah\n",
      "0.6416688392016492\n",
      "[5.54329380e-02 1.32663221e-03 1.26907193e-01 6.16644736e-02\n",
      " 1.33594873e+00 4.69248702e-02 8.38360603e-01 6.94890160e-02]\n",
      "0.6416688392016492\n",
      "[5.54329380e-02 1.32663221e-03 1.26907193e-01 6.16644736e-02\n",
      " 1.33594873e+00 4.69248702e-02 8.38360603e-01 6.94890160e-02]\n",
      "=====\n",
      "validation:\n",
      "[42638.35088062155, 43069.71265688885, 43495.19069565759, 43913.68995209143, 44324.479988243955, 44727.967128708995, 45124.82244611715, 45514.911150991546, 45899.09654841914, 46278.1218041208, 46652.04020538516, 47020.65190578423, 47385.182281490524, 47746.472123209765, 48104.19285815562, 48457.482448805895, 48807.94009645606, 49156.46290246756, 49502.11389931552, 49844.71207744099, 50185.85170433533, 50525.55938541244, 50862.68756534276, 51198.21284296661, 51533.16853975039, 51866.98810970045]\n",
      "prediction:\n",
      "[52198.85692006648, 52530.027450970665, 52860.54756987372, 53190.09030116813, 53519.10317807351, 53847.858173945926, 54176.13506432785, 54503.53142109644, 54830.82405448495, 55158.51864357463, 55486.14607092044, 55812.74166546296, 56139.45037946759, 56466.96701235266, 56794.35793917374, 57121.049194880965, 57448.461790121364, 57776.632743535614, 58104.28166678796, 58431.90041145958, 58760.620376836094, 59089.95876965592, 59418.49205636219, 59747.52009018723, 60077.9536717454, 60408.73292179178]\n",
      "=====\n",
      "Vermont\n",
      "3.5331433533980805\n",
      "[1.00000000e-05 9.89652816e-03 2.62738240e-01 6.75331554e-02\n",
      " 1.66012807e+00 8.92668133e-02 6.78517094e-01 3.99801692e-02]\n",
      "0.3890102223867346\n",
      "[7.70326065e-02 5.94152202e-04 9.86303283e-02 2.72601950e-02\n",
      " 1.24580378e+00 1.00000000e-02 8.47298934e-01 9.26954615e-02]\n",
      "0.3890102223867346\n",
      "[7.70326065e-02 5.94152202e-04 9.86303283e-02 2.72601950e-02\n",
      " 1.24580378e+00 1.00000000e-02 8.47298934e-01 9.26954615e-02]\n",
      "=====\n",
      "validation:\n",
      "[1442.6876239226108, 1448.4070856576204, 1454.2950629339948, 1460.3274243328074, 1466.4807786046576, 1472.7587106936708, 1479.1513260717884, 1485.6575106456753, 1492.2828445538498, 1499.023848152181, 1505.8692868335613, 1512.826391684054, 1519.9093059785691, 1527.1157028017285, 1534.4263968579967, 1541.8272527615968, 1549.3506923455798, 1557.001067139142, 1564.74962962566, 1572.6025891031825, 1580.5783227223876, 1588.6673776779367, 1596.8509617725504, 1605.1493515588747, 1613.5722000563019, 1622.1045069024904]\n",
      "prediction:\n",
      "[1630.7299717316096, 1639.4698876067332, 1648.3208557735743, 1657.2777229417547, 1666.3467885115733, 1675.5297542073172, 1684.8205613354007, 1694.2080897795895, 1703.7052809971065, 1713.3263576714671, 1723.0638711278166, 1732.8901480876202, 1742.8117441921663, 1752.8624294190722, 1763.034814256438, 1773.2880841940948, 1783.6447458815328, 1794.1334529026715, 1804.7362093682782, 1815.4133397219514, 1826.2042711362258, 1837.1316389758056, 1848.1662891114288, 1859.2678172959972, 1870.491331479973, 1881.8565896025534]\n",
      "=====\n",
      "Virginia\n",
      "0.45892260549013936\n",
      "[0.07732861 0.00324859 0.16502063 0.05382585 1.44553753 0.06136159\n",
      " 0.78224659 0.05886524]\n",
      "0.45892260549013936\n",
      "[0.07732861 0.00324859 0.16502063 0.05382585 1.44553753 0.06136159\n",
      " 0.78224659 0.05886524]\n",
      "=====\n",
      "validation:\n",
      "[95868.69275294595, 97072.1670563925, 98249.31144958524, 99395.77307817382, 100510.5054909515, 101594.57627851727, 102651.2306604411, 103681.04878495671, 104686.77547286077, 105671.40409995077, 106636.24509416471, 107581.30956581898, 108509.59068867081, 109424.81414190566, 110328.05990002639, 111217.71567084383, 112093.13954278867, 112960.00000263564, 113819.69519489346, 114669.74827854133, 115512.00345918632, 116349.00546505336, 117180.48250089932, 118005.65888069573, 118826.89674491645, 119645.24387221699]\n",
      "prediction:\n",
      "[120459.42371907613, 121270.85848542085, 122079.96450192871, 122886.82831759071, 123691.91085811894, 124496.03217030573, 125299.62396919707, 126102.71706597555, 126904.94136796043, 127705.93968418872, 128507.30005657111, 129309.99182573444, 130113.05833627372, 130915.1406678627, 131718.3970500521, 132523.7054745529, 133329.83309589693, 134135.03615735646, 134942.00773663964, 135752.3144724, 136564.52776908845, 137375.25119140916, 138187.2804877418, 139002.9673056265, 139820.54596664238, 140637.42479056746]\n",
      "=====\n",
      "Washington\n",
      "0.5237837513312957\n",
      "[0.06466624 0.00552917 0.14236347 0.06657871 1.36566752 0.10261172\n",
      " 0.83615905 0.0619749 ]\n",
      "0.5237837513312957\n",
      "[0.06466624 0.00552917 0.14236347 0.06657871 1.36566752 0.10261172\n",
      " 0.83615905 0.0619749 ]\n",
      "=====\n",
      "validation:\n",
      "[60880.70451274789, 61601.60089133185, 62302.93635503636, 62982.381789722, 63641.81920621717, 64281.376248486486, 64902.81905402184, 65507.93508802402, 66097.17170098203, 66671.58923151661, 67233.53523353556, 67784.08279234834, 68322.83357527117, 68850.13946912592, 69368.89966573156, 69879.8376262525, 70381.57656065052, 70875.73763685315, 71364.28548484249, 71846.75603921841, 72322.20057519342, 72793.14424127157, 73260.53151669931, 73722.94295118726, 74180.61681190987, 74635.54619075879]\n",
      "prediction:\n",
      "[75087.10110124474, 75535.79971233512, 75981.91160083724, 76425.50081208741, 76866.91641036485, 77306.67853845605, 77745.05927225057, 78182.08119440902, 78617.51739436305, 79051.1573467452, 79484.05770005382, 79916.70059350837, 80348.21936175265, 80778.8158676151, 81209.35413601423, 81639.5870078862, 82068.81161936179, 82498.02766095972, 82927.87564775544, 83357.74773651427, 83786.3985718606, 84215.28494000318, 84645.27356692388, 85075.1247839832, 85504.19863537999, 85934.26355412163]\n",
      "=====\n",
      "West Virginia\n",
      "1.2391507737687577\n",
      "[0.08627038 0.00533903 0.18494991 0.06587347 1.48836179 0.0664499\n",
      " 0.7705085  0.08819821]\n",
      "1.2391507737687577\n",
      "[0.08627038 0.00533903 0.18494991 0.06587347 1.48836179 0.0664499\n",
      " 0.7705085  0.08819821]\n",
      "=====\n",
      "validation:\n",
      "[7291.3178684177265, 7421.697219838188, 7550.424655051134, 7677.068035874544, 7801.474233674768, 7923.764824098256, 8044.249863756542, 8162.958668302127, 8280.174419831643, 8396.18589755897, 8511.098067147566, 8624.872471953098, 8737.823028003215, 8850.3442321957, 8962.522109864702, 9074.12963832666, 9185.031980481923, 9295.88088714255, 9406.827016000652, 9517.52782366921, 9628.16045649427, 9739.022414011637, 9850.053405955445, 9961.11774199576, 10072.48709299818, 10184.272488383289]\n",
      "prediction:\n",
      "[10296.289664240936, 10408.694342987863, 10521.512732820394, 10634.739750620833, 10748.445025971483, 10862.693768082474, 10977.511393540946, 11092.883526311063, 11208.755992927403, 11325.10601793786, 11442.137194809067, 11559.925312529404, 11678.308449347809, 11797.132432323193, 11916.706488876314, 12037.136320762456, 12158.214432141353, 12279.646553249335, 12401.871698716966, 12525.168363638893, 12649.295280662449, 12773.642336038423, 12898.659881097234, 13024.756424514959, 13151.621343310402, 13278.88887230321]\n",
      "=====\n",
      "Wisconsin\n",
      "0.4272290093053176\n",
      "[0.0780087  0.00169893 0.1678573  0.06158845 1.43645892 0.07272551\n",
      " 0.79661136 0.0753473 ]\n",
      "0.4272290093053176\n",
      "[0.0780087  0.00169893 0.1678573  0.06158845 1.43645892 0.07272551\n",
      " 0.79661136 0.0753473 ]\n",
      "=====\n",
      "validation:\n",
      "[57779.392857840314, 58616.83281853011, 59441.70858846484, 60251.18444671856, 61044.97828575836, 61823.41488021197, 62588.69216387164, 63341.13721238655, 64082.04702574018, 64813.51393153487, 65536.43228096103, 66250.46324385672, 66956.57609734451, 67658.17342391901, 68356.45135800054, 69050.02995736232, 69736.46426922208, 70420.16109746604, 71103.04284521645, 71782.91287992583, 72460.62059893543, 73137.95448359806, 73814.46894784264, 74489.81288879713, 75165.5923479684, 75842.34171739494]\n",
      "prediction:\n",
      "[76518.79830759765, 77196.1685309461, 77874.65718789495, 78554.16772029654, 79235.07288836937, 79917.94189483038, 80602.96147506464, 81289.93170677009, 81978.28949836925, 82668.41740510862, 83361.72758747404, 84058.15142443948, 84756.05102477164, 85455.76501407604, 86159.344623924, 86866.62297526734, 87575.22087358509, 88285.33880389987, 89000.23244590005, 89719.88697369075, 90440.6901652122, 91161.85939411857, 91888.41355669466, 92620.54488723079, 93353.23943848452, 94087.11805106266]\n",
      "=====\n",
      "Wyoming\n",
      "1.9013357869363006\n",
      "[0.0986538  0.00199449 0.18944428 0.04111935 1.47967688 0.06675385\n",
      " 0.76882555 0.07169431]\n",
      "1.8973765332383268\n",
      "[0.09000159 0.00277354 0.16082343 0.04923449 1.42268132 0.05908691\n",
      " 0.79498882 0.05429242]\n",
      "1.896204421117111\n",
      "[0.08191191 0.00494751 0.13712478 0.06211305 1.36442216 0.05270558\n",
      " 0.82931261 0.03462111]\n",
      "1.8962044121120438\n",
      "[0.08191193 0.00494752 0.13712478 0.06211305 1.36442217 0.05270558\n",
      " 0.82931259 0.03462104]\n",
      "1.8962044868585846\n",
      "[0.08191198 0.00494764 0.13712477 0.06211314 1.36442226 0.05270557\n",
      " 0.82931243 0.03462041]\n",
      "1.8987371713920582\n",
      "[0.09103819 0.00289671 0.15952467 0.04883242 1.41933314 0.05861302\n",
      " 0.79659118 0.05241733]\n",
      "1.895912024001825\n",
      "[0.0728326  0.0018852  0.13363324 0.06546138 1.36202953 0.0495692\n",
      " 0.82473482 0.07536629]\n",
      "1.8962042965031363\n",
      "[0.0819121  0.00494766 0.13712465 0.06211312 1.36442202 0.05270555\n",
      " 0.82931253 0.03462031]\n",
      "1.8962042819025031\n",
      "[0.08191194 0.00494747 0.13712474 0.06211303 1.36442205 0.05270558\n",
      " 0.8293127  0.03462126]\n",
      "1.8962044990334959\n",
      "[0.08191195 0.00494763 0.13712476 0.06211314 1.36442224 0.05270557\n",
      " 0.82931245 0.03462048]\n",
      "1.895912024001825\n",
      "[0.0728326  0.0018852  0.13363324 0.06546138 1.36202953 0.0495692\n",
      " 0.82473482 0.07536629]\n",
      "=====\n",
      "validation:\n",
      "[2926.1802129568496, 2962.679187519578, 2999.4360552672974, 3036.319750684615, 3073.255921652649, 3110.2270664997823, 3147.273562427259, 3184.3590141905065, 3221.5064035036553, 3258.7711583317064, 3296.1518217315643, 3333.5953844532446, 3371.138706698927, 3408.8813067566816, 3446.8171600849973, 3484.8330599975957, 3522.954114864362, 3561.3329340095643, 3599.94390452977, 3638.6339364128535, 3677.522200887008, 3716.7061473688004, 3756.097371889896, 3795.592217937497, 3835.367990829013, 3875.466772133193]\n",
      "prediction:\n",
      "[3915.7033168366625, 3956.198599371752, 3996.9472497123734, 4037.9307468296247, 4079.181690436466, 4120.717105712251, 4162.5199183385175, 4204.543331435703, 4246.823782843333, 4289.443133253662, 4332.382036751768, 4375.521848209134, 4418.8917820235, 4462.6422989846, 4506.741086756654, 4551.004261700496, 4595.539164787917, 4640.4952417146615, 4685.783204261614, 4731.198528195099, 4776.950146783479, 4823.1484782423695, 4869.623712008586, 4916.241235434227, 4963.264528470209, 5010.712130576662]\n",
      "=====\n"
     ]
    }
   ],
   "source": [
    "def loss(pred,true):\n",
    "    y_true, y_pred = np.array(true), np.array(pred)\n",
    "    return (np.mean(np.abs((y_true - y_pred) / y_true)))*100\n",
    "\n",
    "class SIRModel:\n",
    "    def __init__(self):\n",
    "        self.pred_days=30\n",
    "        self.california_like_states=[\"California\",\n",
    "        \"Michigan\",\n",
    "        \"New Jersey\",\n",
    "        \"New York\",\n",
    "        \"New Hampshire\"]\n",
    "        \n",
    "        self.hawaii_like_states=[\"Hawaii\",\n",
    "            \"Connecticut\",\n",
    "            \"Michigan\",\n",
    "            \"New York\",\n",
    "            \"Kansas\",\n",
    "            \"New Jersey\",\n",
    "            \"Pennsylvania\"]\n",
    "\n",
    "    def fit(self, confirm, death, N,state):\n",
    "        self.N = N\n",
    "        E0=3\n",
    "        UI0=0.25\n",
    "        # returned solution is [S, E,UI,RI,R]\n",
    "        self.__hyperParametersInit = [self.N, \n",
    "                                      E0 * confirm[0], \n",
    "                                      confirm[0]*UI0, \n",
    "                                      confirm[0]-death[0],\n",
    "                                      death[0]]\n",
    "        # beta, gamma, sigma, mu, E0, UI0, phi,a\n",
    "        if state in self.california_like_states:\n",
    "            self.__parametersInit = [1e-3, 8e-2, 8e-1, 3e-1, 3,0.25,8e-2,0.2]\n",
    "            self.__bounds = [(1e-5, 2), (1e-5, 1), (1e-5, 1e-1), (1e-5, 1e-2),(1, 5),(1e-2,1),(1e-7, 1e-1),(1e-5,1)]\n",
    "        elif state in self.hawaii_like_states:\n",
    "            self.__parametersInit = [1e-3, 8e-2, 8e-1, 3e-1, 3,0.25,8e-2,0.2]\n",
    "            self.__bounds = [(1e-5, 2), (1e-5, 1), (1e-5, 1e-1), (1e-5, 1e-1),(1, 5),(1e-2,1),(1e-7, 1e-2),(1e-5,1)]\n",
    "        else:\n",
    "            self.__parametersInit = [1e-3, 8e-2, 8e-1, 3e-1, 3,0.25,8e-2,0.2]\n",
    "            self.__bounds = [(1e-5, 2), (1e-5, 1), (1e-5, 1), (1e-5, 1),(1, 5),(1e-2,1),(1e-7, 1),(1e-5,1)]\n",
    "        assert len(confirm) == len(death)\n",
    "        self.__trainingData = [confirm[:-self.pred_days], death[:-self.pred_days]]\n",
    "        self.__testingData = [confirm[-self.pred_days:], death[-self.pred_days:]]\n",
    "        self.__loss_contribution = np.array([[1], [1]])  # whether I/D is more important in MSE\n",
    "        optimal_best_val=9999999\n",
    "        optimal_best=None\n",
    "        for i in range(10):\n",
    "            optimal = minimize(self.__iteration, self.__parametersInit, method='L-BFGS-B', bounds=self.__bounds,tol=1e-8)\n",
    "            print(optimal.fun)\n",
    "            print(optimal.x)\n",
    "            if optimal.fun<1.8:\n",
    "                optimal_best=optimal\n",
    "                break\n",
    "            if optimal.fun<optimal_best_val:\n",
    "                optimal_best=optimal\n",
    "                optimal_best_val=optimal.fun\n",
    "        optimal=optimal_best\n",
    "        self.__parameters = optimal.x\n",
    "        self.__iteration(self.__parameters)\n",
    "        tmp_train_result = self.gather_results_train(sz=len(confirm))\n",
    "        print(optimal.fun)\n",
    "        print(optimal.x)\n",
    "        \n",
    "        \n",
    "\n",
    "    def __make_cal_gradients(self, parameters):\n",
    "        beta, gamma,sigma, mu,_,_,phi,  _ = parameters\n",
    "        def calc_grad(_, y):\n",
    "            S, E, UI, RI, _ = y\n",
    "            #TODO: modified\n",
    "            return [-beta*S*((UI+E+RI))/self.N, #dS\n",
    "                    beta*S*((UI+E+RI))/self.N-sigma*E, #dE\n",
    "                    sigma*E-phi*UI-mu*UI, #dUI\n",
    "                    mu*UI-gamma*RI, #dRI\n",
    "                    gamma*RI] #dR\n",
    "\n",
    "        return calc_grad\n",
    "\n",
    "    def __iteration(self, parameters):\n",
    "        try:\n",
    "            calc_grad = self.__make_cal_gradients(parameters)\n",
    "            [confirm, death] = self.__trainingData\n",
    "            sz=len(confirm)\n",
    "            self.__hyperParametersInit = [self.N, \n",
    "                              parameters[-4] * confirm[0], \n",
    "                              confirm[0]*parameters[-3], \n",
    "                              confirm[0]-death[0]/parameters[-1],\n",
    "                              death[0]/parameters[-1]]\n",
    "    \n",
    "            if (confirm[0]-death[0]/parameters[-1])<0: return 9999+random.randint(1,100)\n",
    "            sol = solve_ivp(calc_grad, [0, sz], self.__hyperParametersInit, t_eval=np.arange(0, sz, 1))\n",
    "            pred_results=sol.y\n",
    "            pred_death=[parameters[-1]*recover for recover in pred_results[-1]]\n",
    "            pred_confirm=pred_results[-2]+pred_results[-1]\n",
    "            for x in pred_results:\n",
    "                for t in x:\n",
    "                    if t<0:\n",
    "                        return 9999+random.randint(1,100)\n",
    "            res=(loss(pred_confirm,confirm)+(loss(pred_death,death)))/2\n",
    "#             if res<2: print(res)\n",
    "            return res\n",
    "        except:\n",
    "            return 9999+random.randint(1,100)\n",
    "        \n",
    "    def gather_results_train(self,sz=45):\n",
    "        calc_grad = self.__make_cal_gradients(self.__parameters)\n",
    "        solution = solve_ivp(calc_grad,[0, sz],self.__hyperParametersInit, t_eval=np.arange(0, sz, 1))\n",
    "        return solution.y\n",
    "    \n",
    "    def gather_results_test(self,training_results,sz=30):\n",
    "        sz=sz+1 #extra day for the first day given\n",
    "        calc_grad = self.__make_cal_gradients(self.__parameters)\n",
    "        init_for_test=[item[-1] for item in training_results]\n",
    "        solution = solve_ivp(calc_grad,[0, sz],init_for_test, t_eval=np.arange(0, sz, 1))\n",
    "        return [item[1:] for item in solution.y]\n",
    "    \n",
    "    def to_submission(self,total_days,predict_days):\n",
    "        \n",
    "        train_result = self.gather_results_train(sz=(total_days-predict_days))\n",
    "        train_pred_confirm=(train_result[-1]+train_result[-2]).tolist()\n",
    "\n",
    "        train_pred_death=[self.__parameters[-1]*recover for recover in train_result[-1]]\n",
    "\n",
    "        test_result = model.gather_results_test(train_result,sz=predict_days)\n",
    "        test_pred_confirm=(test_result[-1]+test_result[-2]).tolist()\n",
    "        \n",
    "        test_pred_death=[self.__parameters[-1]*recover for recover in test_result[-1]]\n",
    "        \n",
    "        return [[train_pred_confirm[-26:],train_pred_death[-26:]],\n",
    "                [test_pred_confirm[:26],test_pred_death[:26]]]\n",
    "        \n",
    "        \n",
    "        \n",
    "\n",
    "if __name__ == '__main__':\n",
    "    \n",
    "    df_test_given=pandas.read_csv(\"test.csv\")\n",
    "#     df_population=pandas.read_csv(\"state_population_2019.csv\",header=None)\n",
    "    populations=[4903185, 731545, 7278717, 3017804, \n",
    "                 39512223, 5758736, 3565287, 973764, \n",
    "                 21477737, 10617423, 1415872, 1787065, \n",
    "                 12671821, 6732219, 3155070, 2913314, \n",
    "                 4467673, 4648794, 1344212, 6045680, \n",
    "                 6892503, 9986857, 5639632, 2976149, \n",
    "                 6137428, 1068778, 1934408, 3080156, \n",
    "                 1359711, 8882190, 2096829, 19453561, \n",
    "                 10488084, 762062, 11689100, 3956971, \n",
    "                 4217737, 12801989, 1059361, 5148714, \n",
    "                 884659, 6829174, 28995881, 3205958, \n",
    "                 623989, 8535519, 7614893, 1792147, \n",
    "                 5822434, 578759]\n",
    "    \n",
    "    state_list=df_test_given[\"Province_State\"][:50].tolist()\n",
    "    \n",
    "#     not_okay=[\"Connecticut\",\n",
    "#             \"California\",\n",
    "#             \"Hawaii\",\n",
    "#             \"Michigan\",\n",
    "#             \"New York\",\n",
    "#             \"Kansas\",\n",
    "#             \"New Jersey\",\n",
    "#             \"Massachusetts\",\n",
    "#             \"Pennsylvania\"]\n",
    "    total_pred_confirm=[-1]*1300\n",
    "    total_pred_death=[-1]*1300\n",
    "\n",
    "    total_valid_confirm=[-1]*1300\n",
    "    total_valid_death=[-1]*1300\n",
    "    for i,State in enumerate(state_list):\n",
    "        n=populations[i]\n",
    "        if State==\"District of Columbia\":\n",
    "            continue\n",
    "#         if State in not_okay:\n",
    "#             continue\n",
    "\n",
    "        confirm_sep=[0]*30\n",
    "        death_sep=[0]*30\n",
    "\n",
    "        print(State)\n",
    "        model = SIRModel()\n",
    "        ## data from california, Parameter not tuned\n",
    "        df = pandas.read_csv(\"train.csv\")\n",
    "\n",
    "        state_df=get_state_ndays_data(df, State, \"05-13-2020\", \"08-31-2020\")\n",
    "        confirm=state_df['Confirmed'].to_numpy()\n",
    "        death=state_df['Deaths'].to_numpy()\n",
    "\n",
    "        total_days=60\n",
    "        predict_days=30\n",
    "\n",
    "        confirm_total=np.append(confirm[-(total_days-predict_days):],confirm_sep)\n",
    "        death_total=np.append(death[-(total_days-predict_days):],death_sep)\n",
    "        model.fit(confirm_total, death_total, n,State)\n",
    "\n",
    "        valid_res,pred_res=model.to_submission(total_days,predict_days)\n",
    "        sub_confirm,sub_death=pred_res\n",
    "        v_confirm,v_death=valid_res\n",
    "        \n",
    "        for k in range(len(sub_confirm)):\n",
    "            total_pred_confirm[k*50+i]=int(sub_confirm[k])\n",
    "            total_pred_death[k*50+i]=int(sub_death[k])\n",
    "        for k in range(len(v_confirm)):\n",
    "            total_valid_confirm[k*50+i]=int(v_confirm[k])\n",
    "            total_valid_death[k*50+i]=int(v_death[k])\n",
    "        print(\"=\"*5)\n",
    "        print(\"validation:\")\n",
    "        print(v_confirm)\n",
    "        print(\"prediction:\")\n",
    "        print(sub_confirm)\n",
    "        print(\"=\"*5)\n",
    "    \n",
    "    df_submission=df_test_given.iloc[:,:2]\n",
    "    df_submission[\"Confirmed\"]=total_pred_confirm\n",
    "    df_submission[\"Deaths\"]=total_pred_death\n",
    "    \n",
    "    df_validation=df_test_given.iloc[:,:2]\n",
    "    df_validation[\"Confirmed\"]=total_valid_confirm\n",
    "    df_validation[\"Deaths\"]=total_valid_death\n",
    "    \n",
    "    \n",
    "    df_new=df_submission.drop(columns=\"Province_State\")\n",
    "    df_new.to_csv(\"submission_tuning.csv\",index=False)\n",
    "    \n",
    "    df_new=df_validation.drop(columns=\"Province_State\")\n",
    "    df_new.to_csv(\"validation_tuning.csv\",index=False)\n",
    "        \n",
    "    \n",
    "    \n",
    "    \n",
    "    \n",
    "    \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ForecastID</th>\n",
       "      <th>Confirmed</th>\n",
       "      <th>Deaths</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>123923</td>\n",
       "      <td>2217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>5421</td>\n",
       "      <td>35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>202329</td>\n",
       "      <td>5079</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>60531</td>\n",
       "      <td>799</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>749566</td>\n",
       "      <td>13623</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1295</th>\n",
       "      <td>1295</td>\n",
       "      <td>140633</td>\n",
       "      <td>2995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1296</th>\n",
       "      <td>1296</td>\n",
       "      <td>85988</td>\n",
       "      <td>2381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1297</th>\n",
       "      <td>1297</td>\n",
       "      <td>13105</td>\n",
       "      <td>310</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1298</th>\n",
       "      <td>1298</td>\n",
       "      <td>94171</td>\n",
       "      <td>1369</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1299</th>\n",
       "      <td>1299</td>\n",
       "      <td>4981</td>\n",
       "      <td>52</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1300 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      ForecastID  Confirmed  Deaths\n",
       "0              0     123923    2217\n",
       "1              1       5421      35\n",
       "2              2     202329    5079\n",
       "3              3      60531     799\n",
       "4              4     749566   13623\n",
       "...          ...        ...     ...\n",
       "1295        1295     140633    2995\n",
       "1296        1296      85988    2381\n",
       "1297        1297      13105     310\n",
       "1298        1298      94171    1369\n",
       "1299        1299       4981      52\n",
       "\n",
       "[1300 rows x 3 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "covid_lab",
   "language": "python",
   "name": "covid_lab"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
